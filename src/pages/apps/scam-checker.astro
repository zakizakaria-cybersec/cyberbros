---
import MainLayout from '../../layouts/MainLayout.astro';
import Navigation from '../../components/Navigation.astro';
import {
  SocialShare,
  WhatsAppShareButton,
  FacebookShareButton,
  LinkedInShareButton,
  EmailShareButton,
  TwitterShareButton
} from 'astro-social-share';
---

<MainLayout 
  title="Universal Scam Checker - CyberBros | For Buyers, Sellers & Investors" 
  description="Free scam detection tool for any transaction. Check for red flags whether you're buying, selling, investing, or receiving payment. Covers WhatsApp group scams, payment fraud, and more."
  canonicalURL={new URL(Astro.url.pathname.replace(/\/$/, '') || '/', Astro.site).href}
>
  <Navigation />
  
  <div class="bg-gradient-to-br from-gray-900 via-black to-gray-900 min-h-screen py-12">
    <div class="max-w-4xl mx-auto px-6">
      
      <!-- Header -->
      <div class="text-center mb-12">
        <a href="/apps" class="inline-flex items-center text-indigo-400 hover:text-indigo-300 mb-6 transition">
          <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
          </svg>
          Back to Apps
        </a>
        <h1 class="text-4xl md:text-5xl font-bold text-white mb-4">
          Universal <span class="text-indigo-400">Scam Checker</span>
        </h1>
        <p class="text-lg text-gray-300 max-w-2xl mx-auto">
          Answer questions about your transaction to receive a risk assessment. 
          For buyers, sellers, individuals, and businesses. Works for any transaction type.
        </p>
      </div>

      <!-- Statistics Display -->
      <div class="mb-8">
        <div class="bg-gradient-to-br from-indigo-900/20 to-purple-900/20 border border-indigo-700/50 rounded-xl p-6">
          <div class="text-center">
            <h3 class="text-white font-semibold mb-4 flex items-center justify-center gap-2">
              <svg class="w-5 h-5 text-indigo-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/>
              </svg>
              Community Impact
            </h3>
            <div class="grid grid-cols-2 gap-6 max-w-md mx-auto mb-6">
              <div class="bg-gray-900/50 rounded-lg p-4">
                <div id="totalChecks" class="text-3xl font-bold text-indigo-400 mb-1 animate-pulse">
                  ---
                </div>
                <div class="text-gray-400 text-sm">Total Risk Checks</div>
              </div>
              <div class="bg-gray-900/50 rounded-lg p-4">
                <div id="todayChecks" class="text-3xl font-bold text-purple-400 mb-1 animate-pulse">
                  ---
                </div>
                <div class="text-gray-400 text-sm">Checks Today</div>
              </div>
            </div>

            <!-- Top Scam Types -->
            <div id="topScamTypesContainer" class="bg-gray-900/30 rounded-lg p-4 border border-gray-700/50">
              <h4 class="text-white font-medium text-sm mb-3 flex items-center justify-center gap-2">
                <svg class="w-4 h-4 text-red-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/>
                </svg>
                Most Checked Scam Types
              </h4>
              <div id="topScamTypes" class="space-y-3">
                <div class="text-gray-500 text-xs animate-pulse">Loading...</div>
              </div>
            </div>

            <p class="text-gray-400 text-xs mt-4 flex items-center justify-center gap-1">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"/>
              </svg>
              Helping Malaysians stay safe from scams
            </p>
          </div>
        </div>
      </div>

      <!-- Disclaimer -->
      <div id="disclaimerBanner" class="bg-yellow-900/20 border border-yellow-700/50 rounded-lg p-4 mb-8">
        <div class="flex items-start gap-3">
          <svg class="w-6 h-6 text-yellow-400 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/>
          </svg>
          <div class="flex-1">
            <div class="flex flex-col sm:flex-row sm:items-start sm:justify-between gap-3">
              <div>
                <h3 class="text-yellow-400 font-semibold mb-1">Disclaimer</h3>
                <p class="text-gray-300 text-sm">
                  This tool provides general guidance only and should not be considered as professional advice. 
                  Always conduct thorough due diligence and consult with professionals for significant business transactions.
                </p>
              </div>
              <button 
                type="button"
                id="dismissDisclaimer"
                class="inline-flex items-center justify-center bg-yellow-700/30 hover:bg-yellow-700/40 text-yellow-200 w-8 h-8 rounded-full transition"
                aria-label="Close disclaimer"
              >
                <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                </svg>
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Progress Bar -->
      <div class="mb-8">
        <div class="flex justify-between items-center mb-2">
          <span class="text-sm text-gray-400">Question <span id="currentQuestion">1</span> of <span id="totalQuestions">8</span></span>
          <span class="text-sm text-indigo-400"><span id="progressPercent">0</span>% Complete</span>
        </div>
        <div class="w-full bg-gray-800 rounded-full h-2">
          <div id="progressBar" class="bg-gradient-to-r from-indigo-600 to-purple-600 h-2 rounded-full transition-all duration-500" style="width: 0%"></div>
        </div>
      </div>

      <!-- Form -->
      <form id="scamCheckerForm" class="space-y-8">
        
        <!-- Q1: What's Happening? -->
        <div class="question-card bg-gradient-to-br from-gray-900 to-gray-800 border border-gray-700 rounded-xl p-6 hover:border-gray-600 transition-all" data-question="1">
          <label class="block text-white font-semibold mb-4 text-lg">
            <span class="inline-flex items-center justify-center w-8 h-8 bg-indigo-600 rounded-full text-sm mr-3">1</span>
            What's Happening?
            <span class="text-red-400 ml-1">*</span>
          </label>
          <div class="flex flex-col gap-3">
            <button type="button" class="option-btn-full has-tooltip" data-field="situation" data-value="buying">
              <span class="text-xl mr-2">ï¿½</span> I want to buy/pay for something
              <span class="tooltip">You're looking to purchase goods, services, or make a payment.</span>
            </button>
            <button type="button" class="option-btn-full has-tooltip" data-field="situation" data-value="selling">
              <span class="text-xl mr-2">ğŸ’¼</span> I want to sell/receive payment
              <span class="tooltip">You're selling goods, services, or expecting to receive payment.</span>
            </button>
            <button type="button" class="option-btn-full has-tooltip" data-field="situation" data-value="contacted">
              <span class="text-xl mr-2">ï¿½</span> Someone contacted me with an offer
              <span class="tooltip">You received an unsolicited call, message, or email with a business opportunity, job offer, or investment scheme.</span>
            </button>
            <button type="button" class="option-btn-full has-tooltip" data-field="situation" data-value="approached">
              <span class="text-xl mr-2">ğŸš¶</span> Someone approached me in person
              <span class="tooltip">Someone approached you on the street, in a coffee shop, mall, or public place with an offer or proposal.</span>
            </button>
            <button type="button" class="option-btn-full has-tooltip" data-field="situation" data-value="group-added">
              <span class="text-xl mr-2">ğŸ‘¥</span> I was added to a money/investment group
              <span class="tooltip">ğŸš¨ CRITICAL: WhatsApp/Telegram group investment schemes are the #1 scam in Malaysia! All "members" showing profits are fake accounts controlled by scammers.</span>
            </button>
            <button type="button" class="option-btn-full has-tooltip" data-field="situation" data-value="partnership">
              <span class="text-xl mr-2">ğŸ¤</span> Partnership/exchange/collaboration opportunity
              <span class="tooltip">Two-way business arrangement, partnership proposal, or collaboration opportunity where both parties contribute.</span>
            </button>
            <button type="button" class="option-btn-full has-tooltip" data-field="situation" data-value="checking">
              <span class="text-xl mr-2">ğŸ”</span> Just checking for someone else / general inquiry
              <span class="tooltip">You're researching or checking something for a friend, family member, or just learning about scam prevention.</span>
            </button>
          </div>
          <input type="hidden" name="situation" required />
          
          <div id="info-situation" class="info-box hidden mt-4 bg-indigo-900/20 border-l-4 border-indigo-500 p-4 rounded-r-lg">
            <div class="flex items-start">
              <svg class="w-6 h-6 text-indigo-400 mr-3 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
              </svg>
              <div class="flex-1">
                <h4 class="text-indigo-300 font-semibold mb-2">ğŸ’¡ About Your Situation</h4>
                <div id="info-content-situation" class="text-gray-300 text-sm leading-relaxed"></div>
              </div>
            </div>
          </div>
        </div>

        <!-- Q5: Payment Method -->
        <div class="question-card bg-gradient-to-br from-gray-900 to-gray-800 border border-gray-700 rounded-xl p-6 hover:border-gray-600 transition-all" data-question="5">
          <label class="block text-white font-semibold mb-4 text-lg">
            <span class="inline-flex items-center justify-center w-8 h-8 bg-indigo-600 rounded-full text-sm mr-3">5</span>
            Payment Method for Transaction
            <span class="text-red-400 ml-1">*</span>
          </label>
          <div class="grid grid-cols-2 md:grid-cols-3 gap-3">
            <button type="button" class="option-btn has-tooltip" data-field="paymentMethod" data-value="gift-cards">
              <span class="text-2xl mb-1">ğŸ</span>
              <span class="text-sm">Gift Cards</span>
              <span class="tooltip">ğŸš¨ Nearly ALWAYS a scam! No legitimate business uses gift cards for payments.</span>
            </button>
            <button type="button" class="option-btn has-tooltip" data-field="paymentMethod" data-value="cryptocurrency">
              <span class="text-2xl mb-1">â‚¿</span>
              <span class="text-sm">Crypto</span>
              <span class="tooltip">âš ï¸ High risk - irreversible transactions. Scammers love crypto because payments can't be recovered.</span>
            </button>
            <button type="button" class="option-btn has-tooltip" data-field="paymentMethod" data-value="wire-transfer">
              <span class="text-2xl mb-1">ğŸ’¸</span>
              <span class="text-sm">Wire Transfer</span>
              <span class="tooltip">âš ï¸ Risky - difficult to reverse. Used in many business email compromise scams.</span>
            </button>
            <button type="button" class="option-btn has-tooltip" data-field="paymentMethod" data-value="bank-transfer">
              <span class="text-2xl mb-1">ğŸ¦</span>
              <span class="text-sm">Bank Transfer</span>
              <span class="tooltip">âœ“ Relatively safe but verify account details carefully. Use for known parties only.</span>
            </button>
            <button type="button" class="option-btn has-tooltip" data-field="paymentMethod" data-value="check">
              <span class="text-2xl mb-1">ğŸ“</span>
              <span class="text-sm">Check</span>
              <span class="tooltip">âš ï¸ Check scams are common! Banks in Malaysia process checks in 2-3 days - even if money appears, it can bounce later.</span>
            </button>
            <button type="button" class="option-btn has-tooltip" data-field="paymentMethod" data-value="cod">
              <span class="text-2xl mb-1">ğŸ’µ</span>
              <span class="text-sm">Cash/COD</span>
              <span class="tooltip">âœ“ Safe for in-person transactions. Meet in public places for valuable items.</span>
            </button>
            <button type="button" class="option-btn has-tooltip" data-field="paymentMethod" data-value="credit-card">
              <span class="text-2xl mb-1">ğŸ’³</span>
              <span class="text-sm">Credit Card</span>
              <span class="tooltip">âœ“ Safest option - chargeback protection available if fraud occurs.</span>
            </button>
            <button type="button" class="option-btn has-tooltip" data-field="paymentMethod" data-value="escrow">
              <span class="text-2xl mb-1">ğŸ”’</span>
              <span class="text-sm">Escrow</span>
              <span class="tooltip">âœ“ Very safe - funds held by third party until transaction completes. Best for large transactions.</span>
            </button>
            <button type="button" class="option-btn has-tooltip" data-field="paymentMethod" data-value="money-order">
              <span class="text-2xl mb-1">ğŸ“¬</span>
              <span class="text-sm">Money Order</span>
              <span class="tooltip">âš ï¸ Can be counterfeited. Similar risks to checks - funds can appear then disappear.</span>
            </button>
            <button type="button" class="option-btn has-tooltip" data-field="paymentMethod" data-value="not-discussed">
              <span class="text-2xl mb-1">â“</span>
              <span class="text-sm">Not Discussed Yet</span>
              <span class="tooltip">â„¹ï¸ Haven't discussed payment method yet. You should clarify this BEFORE proceeding.</span>
            </button>
          </div>
          <input type="hidden" name="paymentMethod" required />
          
          <!-- Educational Info Box (appears when option selected) -->
          <div id="info-paymentMethod" class="info-box hidden mt-4 bg-indigo-900/20 border-l-4 border-indigo-500 p-4 rounded-r-lg">
            <div class="flex items-start">
              <svg class="w-6 h-6 text-indigo-400 mr-3 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
              </svg>
              <div class="flex-1">
                <div id="info-content-paymentMethod" class="text-gray-300 text-sm leading-relaxed"></div>
              </div>
            </div>
          </div>
        </div>

        <!-- Q2: Red Flag Check -->
        <div class="question-card bg-gradient-to-br from-gray-900 to-gray-800 border border-gray-700 rounded-xl p-6 hover:border-gray-600 transition-all" data-question="2">
          <label class="block text-white font-semibold mb-4 text-lg">
            <span class="inline-flex items-center justify-center w-8 h-8 bg-indigo-600 rounded-full text-sm mr-3">2</span>
            Red Flag Check
            <span class="text-gray-400 text-sm font-normal ml-2">(Select all that apply)</span>
            <span class="text-red-400 ml-1">*</span>
          </label>
          <p class="text-gray-400 text-sm mb-4">Select ALL warning signs that apply to your situation, or select "None" if everything seems normal:</p>
          
          <!-- Critical Red Flags -->
          <div class="mb-6">
            <h3 class="text-red-400 font-semibold text-sm mb-3 flex items-center">
              <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/>
              </svg>
              ğŸš¨ CRITICAL RED FLAGS
            </h3>
            <div class="grid grid-cols-1 gap-2">
              <button type="button" class="option-btn-checkbox has-tooltip" data-field="redFlags" data-value="lie-to-others">
                <span class="checkbox-indicator">â˜</span>
                <span class="flex-1">Asks me to lie to others (bank, family, authorities)</span>
                <span class="tooltip">ğŸš¨ STOP IMMEDIATELY! This is fraud/money laundering. You could face criminal charges.</span>
              </button>
              <button type="button" class="option-btn-checkbox has-tooltip" data-field="redFlags" data-value="secrecy">
                <span class="checkbox-indicator">â˜</span>
                <span class="flex-1">Demands complete secrecy about this deal</span>
                <span class="tooltip">ğŸš¨ Isolation tactic! Legitimate deals don't require secrecy from friends/family.</span>
              </button>
              <button type="button" class="option-btn-checkbox has-tooltip" data-field="redFlags" data-value="account-access">
                <span class="checkbox-indicator">â˜</span>
                <span class="flex-1">Requests my passwords/OTP/account access</span>
                <span class="tooltip">ğŸš¨ NEVER SHARE! No bank or legitimate business asks for passwords or OTP codes.</span>
              </button>
              <button type="button" class="option-btn-checkbox has-tooltip" data-field="redFlags" data-value="secluded-location">
                <span class="checkbox-indicator">â˜</span>
                <span class="flex-1">Meeting in secluded/unsafe location</span>
                <span class="tooltip">ğŸš¨ EXTREME DANGER! Legitimate businesses never meet in secluded areas. Personal safety risk.</span>
              </button>
              <button type="button" class="option-btn-checkbox has-tooltip" data-field="redFlags" data-value="whatsapp-group">
                <span class="checkbox-indicator">â˜</span>
                <span class="flex-1">WhatsApp/Telegram group showing "profits"</span>
                <span class="tooltip">ğŸš¨ #1 scam in Malaysia! ALL "members" are fake accounts. Initial payment is BAIT.</span>
              </button>
              <button type="button" class="option-btn-checkbox has-tooltip" data-field="redFlags" data-value="sending-someone-else">
                <span class="checkbox-indicator">â˜</span>
                <span class="flex-1">Sending someone else instead of meeting personally</span>
                <span class="tooltip">ğŸš¨ Avoiding identity verification! Often a robbery setup or scam handoff.</span>
              </button>
              <button type="button" class="option-btn-checkbox has-tooltip" data-field="redFlags" data-value="evasive-identity">
                <span class="checkbox-indicator">â˜</span>
                <span class="flex-1">Being evasive about who they are</span>
                <span class="tooltip">ğŸš¨ Hiding identity is a critical warning sign. Legitimate parties are transparent.</span>
              </button>
            </div>
          </div>

          <!-- Warning Signs -->
          <div class="mb-6">
            <h3 class="text-yellow-400 font-semibold text-sm mb-3 flex items-center">
              <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/>
              </svg>
              âš ï¸ WARNING SIGNS
            </h3>
            <div class="grid grid-cols-1 gap-2">
              <button type="button" class="option-btn-checkbox has-tooltip" data-field="redFlags" data-value="extreme-urgency">
                <span class="checkbox-indicator">â˜</span>
                <span class="flex-1">Extreme urgency ("act now or lose it!")</span>
                <span class="tooltip">âš ï¸ Pressure tactic to stop you from thinking clearly. Legitimate businesses give you time.</span>
              </button>
              <button type="button" class="option-btn-checkbox has-tooltip" data-field="redFlags" data-value="too-good">
                <span class="checkbox-indicator">â˜</span>
                <span class="flex-1">Too-good-to-be-true offers/returns</span>
                <span class="tooltip">âš ï¸ If it sounds impossible, it IS impossible. This is the #1 psychological hook scammers use.</span>
              </button>
              <button type="button" class="option-btn-checkbox has-tooltip" data-field="redFlags" data-value="fear-tactics">
                <span class="checkbox-indicator">â˜</span>
                <span class="flex-1">Fear tactics or threats</span>
                <span class="tooltip">âš ï¸ Using fear to manipulate you. Real authorities NEVER threaten over phone/messages.</span>
              </button>
              <button type="button" class="option-btn-checkbox has-tooltip" data-field="redFlags" data-value="location-changing">
                <span class="checkbox-indicator">â˜</span>
                <span class="flex-1">Location keeps changing</span>
                <span class="tooltip">âš ï¸ Very suspicious behavior. Scammers change locations to confuse or avoid detection.</span>
              </button>
              <button type="button" class="option-btn-checkbox has-tooltip" data-field="redFlags" data-value="refuses-documentation">
                <span class="checkbox-indicator">â˜</span>
                <span class="flex-1">Refuses to provide documentation</span>
                <span class="tooltip">âš ï¸ Major warning! Legitimate businesses provide receipts, contracts, and documentation.</span>
              </button>
              <button type="button" class="option-btn-checkbox has-tooltip" data-field="redFlags" data-value="excessive-info">
                <span class="checkbox-indicator">â˜</span>
                <span class="flex-1">Requests excessive personal information</span>
                <span class="tooltip">âš ï¸ Identity theft risk! Never share IC photos, passwords, OTP codes, or unnecessary details.</span>
              </button>
              <button type="button" class="option-btn-checkbox has-tooltip" data-field="redFlags" data-value="fake-social-proof">
                <span class="checkbox-indicator">â˜</span>
                <span class="flex-1">Shows fake "social proof" (testimonials, member profits)</span>
                <span class="tooltip">âš ï¸ Fake testimonials and profit screenshots are easily created. Verify independently.</span>
              </button>
              <button type="button" class="option-btn-checkbox has-tooltip" data-field="redFlags" data-value="small-payment-first">
                <span class="checkbox-indicator">â˜</span>
                <span class="flex-1">Small payment first to "prove" legitimacy</span>
                <span class="tooltip">âš ï¸ Classic BAIT! They pay RM100 to gain trust, then scam you for RM1000+.</span>
              </button>
              <button type="button" class="option-btn-checkbox has-tooltip" data-field="redFlags" data-value="unclear-representation">
                <span class="checkbox-indicator">â˜</span>
                <span class="flex-1">Unclear about who will represent them</span>
                <span class="tooltip">âš ï¸ Legitimate parties are transparent about representation and authority.</span>
              </button>
            </div>
          </div>

          <!-- Status Options -->
          <div>
            <h3 class="text-green-400 font-semibold text-sm mb-3 flex items-center">
              <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
              </svg>
              âœ… STATUS
            </h3>
            <div class="grid grid-cols-1 gap-2">
              <button type="button" class="option-btn-checkbox has-tooltip" data-field="redFlags" data-value="none">
                <span class="checkbox-indicator">â˜</span>
                <span class="flex-1">None of these apply</span>
                <span class="tooltip">âœ“ Good! No major red flags detected. Still maintain standard business caution.</span>
              </button>
              <button type="button" class="option-btn-checkbox has-tooltip" data-field="redFlags" data-value="too-early">
                <span class="checkbox-indicator">â˜</span>
                <span class="flex-1">Too early to tell / haven't interacted much yet</span>
                <span class="tooltip">â„¹ï¸ Early stage. Scammers often appear professional initially - stay alert as things progress.</span>
              </button>
            </div>
          </div>

          <input type="hidden" name="redFlags" required />
          
          <div id="info-redFlags" class="info-box hidden mt-4 bg-indigo-900/20 border-l-4 border-indigo-500 p-4 rounded-r-lg">
            <div class="flex items-start">
              <svg class="w-6 h-6 text-indigo-400 mr-3 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
              </svg>
              <div class="flex-1">
                <h4 class="text-indigo-300 font-semibold mb-2">ğŸ’¡ About Red Flags</h4>
                <div id="info-content-redFlags" class="text-gray-300 text-sm leading-relaxed">
                  The more red flags present, the higher the scam risk. <strong>Critical red flags</strong> (ğŸš¨) indicate immediate danger - stop the transaction. <strong>Warning signs</strong> (âš ï¸) suggest potential scam - investigate thoroughly before proceeding.
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Q3: Communication Medium -->
        <div class="question-card bg-gradient-to-br from-gray-900 to-gray-800 border border-gray-700 rounded-xl p-6 hover:border-gray-600 transition-all" data-question="3">
          <label class="block text-white font-semibold mb-4 text-lg">
            <span class="inline-flex items-center justify-center w-8 h-8 bg-indigo-600 rounded-full text-sm mr-3">3</span>
            How Are You Communicating?
            <span class="text-red-400 ml-1">*</span>
          </label>
          <p class="text-gray-400 text-sm mb-4">If you were approached in person, how are you staying in touch now? If it's only face-to-face meetings, select that option below.</p>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
            <button type="button" class="option-btn-full has-tooltip" data-field="communicationMedium" data-value="email">
              <span class="text-xl mr-2">ğŸ“§</span> Email
              <span class="tooltip">âœ“ Professional standard. Check domain carefully for spoofing and verify sender authenticity.</span>
            </button>
            <button type="button" class="option-btn-full has-tooltip" data-field="communicationMedium" data-value="sms">
              <span class="text-xl mr-2">ï¿½</span> SMS/Text Message
              <span class="tooltip">âš ï¸ Professional businesses rarely use SMS for important transactions. Watch for smishing scams.</span>
            </button>
            <button type="button" class="option-btn-full has-tooltip" data-field="communicationMedium" data-value="whatsapp">
              <span class="text-xl mr-2">ï¿½</span> WhatsApp
              <span class="tooltip">âš ï¸ Common in Malaysia but risky for business. Verify numbers and watch for account hijacking.</span>
            </button>
            <button type="button" class="option-btn-full has-tooltip" data-field="communicationMedium" data-value="whatsapp-group">
              <span class="text-xl mr-2">ï¿½</span> WhatsApp Group
              <span class="tooltip">ğŸš¨ CRITICAL RED FLAG! Group investment/money schemes are nearly always scams in Malaysia.</span>
            </button>
            <button type="button" class="option-btn-full has-tooltip" data-field="communicationMedium" data-value="telegram">
              <span class="text-xl mr-2">âœˆï¸</span> Telegram
              <span class="tooltip">âš ï¸ Used for business but also popular with scammers. Verify identity carefully.</span>
            </button>
            <button type="button" class="option-btn-full has-tooltip" data-field="communicationMedium" data-value="social-media">
              <span class="text-xl mr-2">ï¿½</span> Social Media (Facebook, Instagram)
              <span class="tooltip">âš ï¸ Verify account authenticity. Scammers clone business profiles. Check for blue verification badge.</span>
            </button>
            <button type="button" class="option-btn-full has-tooltip" data-field="communicationMedium" data-value="phone-call">
              <span class="text-xl mr-2">ğŸ“</span> Phone Call
              <span class="tooltip">âœ“ Professional option. Be aware of caller ID spoofing. Call back using publicly listed numbers.</span>
            </button>
            <button type="button" class="option-btn-full has-tooltip" data-field="communicationMedium" data-value="video-call">
              <span class="text-xl mr-2">ğŸ“¹</span> Video Call (Zoom, Meet)
              <span class="tooltip">âœ“ Excellent for verification. Harder to fake identity. Request for important transactions.</span>
            </button>
            <button type="button" class="option-btn-full has-tooltip" data-field="communicationMedium" data-value="business-platform">
              <span class="text-xl mr-2">ğŸ’¼</span> Professional Platform (LinkedIn)
              <span class="tooltip">âœ“ More trustworthy. Platforms verify some details. Still check profile authenticity.</span>
            </button>
            <button type="button" class="option-btn-full has-tooltip" data-field="communicationMedium" data-value="marketplace">
              <span class="text-xl mr-2">ğŸ›’</span> Marketplace Platform (Shopee, Lazada)
              <span class="tooltip">âœ“ Safest option. Platforms offer buyer protection and dispute resolution.</span>
            </button>
            <button type="button" class="option-btn-full has-tooltip" data-field="communicationMedium" data-value="in-person-only">
              <span class="text-xl mr-2">ğŸ¤</span> In-Person Meetings Only
              <span class="tooltip">â„¹ï¸ No digital communication - only meeting face-to-face. Common for street approaches or local transactions.</span>
            </button>
            <button type="button" class="option-btn-full has-tooltip" data-field="communicationMedium" data-value="not-started">
              <span class="text-xl mr-2">â“</span> Haven't Started Communicating Yet
              <span class="tooltip">â„¹ï¸ If you haven't begun communicating yet, select this option.</span>
            </button>
          </div>
          <input type="hidden" name="communicationMedium" required />
          
          <div id="info-communicationMedium" class="info-box hidden mt-4 bg-indigo-900/20 border-l-4 border-indigo-500 p-4 rounded-r-lg">
            <div class="flex items-start">
              <svg class="w-6 h-6 text-indigo-400 mr-3 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
              </svg>
              <div class="flex-1">
                <div id="info-content-communicationMedium" class="text-gray-300 text-sm leading-relaxed"></div>
              </div>
            </div>
          </div>
        </div>

        <!-- Q6: Where Is This Happening? -->
        <div class="question-card bg-gradient-to-br from-gray-900 to-gray-800 border border-gray-700 rounded-xl p-6 hover:border-gray-600 transition-all" data-question="6">
          <label class="block text-white font-semibold mb-4 text-lg">
            <span class="inline-flex items-center justify-center w-8 h-8 bg-indigo-600 rounded-full text-sm mr-3">6</span>
            Where Is This Happening?
            <span class="text-red-400 ml-1">*</span>
          </label>
          <div class="flex flex-col gap-3">
            <button type="button" class="option-btn-full has-tooltip" data-field="location" data-value="online-only">
              <span class="text-xl mr-2">ğŸŒ</span> Online Only / Remote
              <span class="tooltip">âœ“ Many legitimate transactions are online. Ensure platform security and use protected payment methods.</span>
            </button>
            <button type="button" class="option-btn-full has-tooltip" data-field="location" data-value="public-place">
              <span class="text-xl mr-2">ğŸ¢</span> Public Place (Mall, Bank, Coffee Shop)
              <span class="tooltip">âœ“ Safest for in-person meetings. Public locations provide security and witnesses.</span>
            </button>
            <button type="button" class="option-btn-full has-tooltip" data-field="location" data-value="street-public">
              <span class="text-xl mr-2">ğŸš¶</span> Street / Public Area (where I was approached)
              <span class="tooltip">âš ï¸ If you were approached on the street, be extra cautious. Verify their identity thoroughly and consider moving to a safer public place like a mall or bank.</span>
            </button>
            <button type="button" class="option-btn-full has-tooltip" data-field="location" data-value="office-business">
              <span class="text-xl mr-2">ğŸª</span> Their Office / Business Location
              <span class="tooltip">âœ“ Good sign - established business location. Verify the address is legitimate before visiting.</span>
            </button>
            <button type="button" class="option-btn-full has-tooltip" data-field="location" data-value="private-residence">
              <span class="text-xl mr-2">ğŸ </span> Private Residence (Theirs or Mine)
              <span class="tooltip">âš ï¸ Risky for high-value transactions. Only for trusted parties. Never meet alone for expensive items.</span>
            </button>
            <button type="button" class="option-btn-full has-tooltip" data-field="location" data-value="secluded-area">
              <span class="text-xl mr-2">ï¿½</span> Secluded / Unusual Location
              <span class="tooltip">ğŸš¨ MAJOR RED FLAG! Legitimate businesses don't meet in secluded areas. High personal safety risk.</span>
            </button>
            <button type="button" class="option-btn-full has-tooltip" data-field="location" data-value="keeps-changing">
              <span class="text-xl mr-2">ğŸ”„</span> Location Keeps Changing
              <span class="tooltip">ğŸš¨ Very suspicious! Scammers change locations to confuse or avoid detection. Major warning sign.</span>
            </button>
            <button type="button" class="option-btn-full has-tooltip" data-field="location" data-value="refuses-specify">
              <span class="text-xl mr-2">â“</span> Refuses to Specify Location
              <span class="tooltip">âš ï¸ Concerning. Legitimate parties are transparent about where business will occur.</span>
            </button>
            <button type="button" class="option-btn-full has-tooltip" data-field="location" data-value="not-applicable">
              <span class="text-xl mr-2">â–</span> Not Applicable / Haven't Discussed Yet
              <span class="tooltip">â„¹ï¸ If you haven't discussed meeting location yet, select this option.</span>
            </button>
          </div>
          <input type="hidden" name="location" required />
          
          <div id="info-location" class="info-box hidden mt-4 bg-indigo-900/20 border-l-4 border-indigo-500 p-4 rounded-r-lg">
            <div class="flex items-start">
              <svg class="w-6 h-6 text-indigo-400 mr-3 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
              </svg>
              <div class="flex-1">
                <div id="info-content-location" class="text-gray-300 text-sm leading-relaxed"></div>
              </div>
            </div>
          </div>
        </div>

        <!-- Q7: Who Will You Meet/Deal With? -->
        <div class="question-card bg-gradient-to-br from-gray-900 to-gray-800 border border-gray-700 rounded-xl p-6 hover:border-gray-600 transition-all" data-question="7">
          <label class="block text-white font-semibold mb-4 text-lg">
            <span class="inline-flex items-center justify-center w-8 h-8 bg-indigo-600 rounded-full text-sm mr-3">7</span>
            Who Will You Meet/Deal With?
            <span class="text-red-400 ml-1">*</span>
          </label>
          <p class="text-gray-400 text-sm mb-4">If this involves meeting or dealing with someone, who will it be?</p>
          <div class="flex flex-col gap-3">
            <button type="button" class="option-btn-full has-tooltip" data-field="whoMeeting" data-value="person-directly">
              <span class="text-xl mr-2">ğŸ‘¤</span> The Person I've Been Communicating With
              <span class="tooltip">âœ“ Best scenario - direct accountability. Verify their identity matches communications.</span>
            </button>
            <button type="button" class="option-btn-full has-tooltip" data-field="whoMeeting" data-value="person-approached-me">
              <span class="text-xl mr-2">ğŸš¶</span> The Person Who Approached Me
              <span class="tooltip">âš ï¸ In-person approaches require extra verification. Request identification and verify their business legitimacy before proceeding.</span>
            </button>
            <button type="button" class="option-btn-full has-tooltip" data-field="whoMeeting" data-value="authorized-representative">
              <span class="text-xl mr-2">ğŸ’¼</span> Authorized Representative / Employee
              <span class="tooltip">âœ“ Normal for businesses. Request authorization letter and verify with company directly.</span>
            </button>
            <button type="button" class="option-btn-full has-tooltip" data-field="whoMeeting" data-value="sending-someone-else">
              <span class="text-xl mr-2">ï¿½</span> Sending Someone Else (Friend/Family)
              <span class="tooltip">ğŸš¨ MAJOR RED FLAG! Why can't they come personally? Scammers avoid face-to-face to hide identity. This is often a robbery setup or scam handoff.</span>
            </button>
            <button type="button" class="option-btn-full has-tooltip" data-field="whoMeeting" data-value="courier-delivery">
              <span class="text-xl mr-2">ï¿½</span> Courier / Delivery Service
              <span class="tooltip">âœ“ Normal for e-commerce. Use reputable courier services. Inspect goods before signing. Be wary of COD scams with fake/damaged items.</span>
            </button>
            <button type="button" class="option-btn-full has-tooltip" data-field="whoMeeting" data-value="unclear-evasive">
              <span class="text-xl mr-2">â“</span> Unclear / Being Evasive About Who
              <span class="tooltip">ğŸš¨ CRITICAL WARNING! Refusing to specify who will meet is extremely suspicious. Legitimate parties are transparent about representation.</span>
            </button>
            <button type="button" class="option-btn-full has-tooltip" data-field="whoMeeting" data-value="online-no-meeting">
              <span class="text-xl mr-2">ğŸŒ</span> No In-Person Meeting (Online Only)
              <span class="tooltip">â„¹ï¸ Common for online transactions. Use secure platforms with buyer protection. Request video call for high-value items.</span>
            </button>
            <button type="button" class="option-btn-full has-tooltip" data-field="whoMeeting" data-value="not-applicable">
              <span class="text-xl mr-2">â–</span> Not Applicable / Haven't Discussed Yet
              <span class="tooltip">â„¹ï¸ If you haven't reached this stage yet, select this option.</span>
            </button>
          </div>
          <input type="hidden" name="whoMeeting" required />
          
          <div id="info-whoMeeting" class="info-box hidden mt-4 bg-indigo-900/20 border-l-4 border-indigo-500 p-4 rounded-r-lg">
            <div class="flex items-start">
              <svg class="w-6 h-6 text-indigo-400 mr-3 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
              </svg>
              <div class="flex-1">
                <div id="info-content-whoMeeting" class="text-gray-300 text-sm leading-relaxed"></div>
              </div>
            </div>
          </div>
        </div>

        <!-- Q4: Relationship/Trust Building -->
        <div class="question-card bg-gradient-to-br from-gray-900 to-gray-800 border border-gray-700 rounded-xl p-6 hover:border-gray-600 transition-all" data-question="4">
          <label class="block text-white font-semibold mb-4 text-lg">
            <span class="inline-flex items-center justify-center w-8 h-8 bg-indigo-600 rounded-full text-sm mr-3">4</span>
            How Did This Interaction Start?
            <span class="text-red-400 ml-1">*</span>
          </label>
          <p class="text-gray-400 text-sm mb-4">Understanding how they initiated contact helps assess trust building tactics:</p>
          <div class="flex flex-col gap-3">
            <button type="button" class="option-btn-full has-tooltip" data-field="relationshipBuilding" data-value="gradual-trust">
              <span class="text-xl mr-2">ğŸ¤</span> Built Trust Gradually Over Time
              <span class="tooltip">âœ“ Normal relationship building. Still verify facts independently before commitment.</span>
            </button>
            <button type="button" class="option-btn-full has-tooltip" data-field="relationshipBuilding" data-value="unsolicited-contact">
              <span class="text-xl mr-2">ğŸ“²</span> They Contacted Me Out of the Blue
              <span class="tooltip">ğŸš¨ High risk! Unsolicited contact is a common scam tactic. Verify legitimacy thoroughly.</span>
            </button>
            <button type="button" class="option-btn-full has-tooltip" data-field="relationshipBuilding" data-value="added-to-group">
              <span class="text-xl mr-2">ğŸ‘¥</span> Added to Group Without Permission
              <span class="tooltip">ğŸš¨ MAJOR RED FLAG! Scammers add victims to fake investment/opportunity groups. Leave immediately.</span>
            </button>
            <button type="button" class="option-btn-full has-tooltip" data-field="relationshipBuilding" data-value="quick-intimacy">
              <span class="text-xl mr-2">ğŸ’•</span> Moved to Personal Topics Very Quickly
              <span class="tooltip">ğŸš¨ Love scam tactic! Rushing emotional intimacy to cloud judgment. Real relationships develop naturally.</span>
            </button>
            <button type="button" class="option-btn-full has-tooltip" data-field="relationshipBuilding" data-value="professional-approach">
              <span class="text-xl mr-2">ğŸ’¼</span> Professional Business Approach
              <span class="tooltip">âœ“ Good sign! Maintains professional boundaries and clear business focus.</span>
            </button>
            <button type="button" class="option-btn-full has-tooltip" data-field="relationshipBuilding" data-value="mutual-connection">
              <span class="text-xl mr-2">ğŸ”—</span> Introduced Through Mutual Connection
              <span class="tooltip">âœ“ Better! Still verify independently - scammers can compromise accounts or fake connections.</span>
            </button>
            <button type="button" class="option-btn-full has-tooltip" data-field="relationshipBuilding" data-value="responded-to-ad">
              <span class="text-xl mr-2">ğŸ“¢</span> I Responded to Their Ad/Listing
              <span class="tooltip">â„¹ï¸ Common for marketplace. Verify seller/buyer reputation and use platform protections.</span>
            </button>
            <button type="button" class="option-btn-full has-tooltip" data-field="relationshipBuilding" data-value="not-sure">
              <span class="text-xl mr-2">ğŸ¤”</span> Not Sure / Can't Remember
              <span class="tooltip">âš ï¸ Try to recall how it started. Understanding first contact helps identify scam patterns.</span>
            </button>
          </div>
          <input type="hidden" name="relationshipBuilding" required />
          
          <div id="info-relationshipBuilding" class="info-box hidden mt-4 bg-indigo-900/20 border-l-4 border-indigo-500 p-4 rounded-r-lg">
            <div class="flex items-start">
              <svg class="w-6 h-6 text-indigo-400 mr-3 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
              </svg>
              <div class="flex-1">
                <div id="info-content-relationshipBuilding" class="text-gray-300 text-sm leading-relaxed"></div>
              </div>
            </div>
          </div>
        </div>

        <!-- Q8: Information About Other Party -->
        <div class="question-card bg-gradient-to-br from-gray-900 to-gray-800 border border-gray-700 rounded-xl p-6 hover:border-gray-600 transition-all" data-question="8">
          <label class="block text-white font-semibold mb-4 text-lg">
            <span class="inline-flex items-center justify-center w-8 h-8 bg-indigo-600 rounded-full text-sm mr-3">8</span>
            Information You Have About the Other Party
            <span class="text-gray-400 text-sm font-normal ml-2">(Select all that apply)</span>
            <span class="text-red-400 ml-1">*</span>
          </label>
          <p class="text-gray-400 text-sm mb-4">Select all the information you've been able to verify or collect about the other party:</p>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
            <button type="button" class="option-btn-checkbox has-tooltip" data-field="partyInfo" data-value="phone-number">
              <span class="checkbox-indicator">â˜</span>
              <span class="text-xl mr-2">ï¿½</span> Phone Number
              <span class="tooltip">âœ“ Basic info. Verify it's active. Check if it's on known scam lists at CCID or MCMC.</span>
            </button>
            <button type="button" class="option-btn-checkbox has-tooltip" data-field="partyInfo" data-value="identification">
              <span class="checkbox-indicator">â˜</span>
              <span class="text-xl mr-2">ğŸªª</span> Identification Details (IC/Passport)
              <span class="tooltip">âœ“ Important verification. Compare name with business records. Check if IC number format is valid.</span>
            </button>
            <button type="button" class="option-btn-checkbox has-tooltip" data-field="partyInfo" data-value="email">
              <span class="checkbox-indicator">â˜</span>
              <span class="text-xl mr-2">ğŸ“§</span> Professional Email Address
              <span class="tooltip">âœ“ Check domain matches business. Professional email (@company.com) is better than free email.</span>
            </button>
            <button type="button" class="option-btn-checkbox has-tooltip" data-field="partyInfo" data-value="profile-picture">
              <span class="checkbox-indicator">â˜</span>
              <span class="text-xl mr-2">ï¿½</span> Profile Picture/Photo
              <span class="tooltip">âš ï¸ Photos can be stolen. Do reverse image search on Google to verify authenticity.</span>
            </button>
            <button type="button" class="option-btn-checkbox has-tooltip" data-field="partyInfo" data-value="references">
              <span class="checkbox-indicator">â˜</span>
              <span class="text-xl mr-2">ğŸ‘¥</span> Acquaintances/References
              <span class="tooltip">âœ“ Valuable! Contact references independently. Verify they're real people through LinkedIn/Facebook.</span>
            </button>
            <button type="button" class="option-btn-checkbox has-tooltip" data-field="partyInfo" data-value="age">
              <span class="checkbox-indicator">â˜</span>
              <span class="text-xl mr-2">ğŸ‚</span> Age/Date of Birth
              <span class="tooltip">âš ï¸ Limited value alone. Cross-check with IC if provided. Ensure consistency across documents.</span>
            </button>
            <button type="button" class="option-btn-checkbox has-tooltip" data-field="partyInfo" data-value="location">
              <span class="checkbox-indicator">â˜</span>
              <span class="text-xl mr-2">ï¿½</span> Physical Address/Location
              <span class="tooltip">âœ“ Verify on Google Maps. Check if it's real business location or residential. Visit if possible.</span>
            </button>
            <button type="button" class="option-btn-checkbox has-tooltip" data-field="partyInfo" data-value="business-registration">
              <span class="checkbox-indicator">â˜</span>
              <span class="text-xl mr-2">ğŸ“‹</span> Business Registration (SSM)
              <span class="tooltip">âœ“ CRITICAL! Verify at ssm.com.my. Check registration number, directors, business status.</span>
            </button>
            <button type="button" class="option-btn-checkbox has-tooltip" data-field="partyInfo" data-value="social-media">
              <span class="checkbox-indicator">â˜</span>
              <span class="text-xl mr-2">ğŸ’¬</span> Active Social Media Profiles
              <span class="tooltip">âœ“ Check profile age, activity history, followers. Fake profiles are usually new with little activity.</span>
            </button>
            <button type="button" class="option-btn-checkbox has-tooltip" data-field="partyInfo" data-value="website">
              <span class="checkbox-indicator">â˜</span>
              <span class="text-xl mr-2">ğŸŒ</span> Professional Website
              <span class="tooltip">âœ“ Check domain age, SSL certificate, contact info. Scam sites are often new and poorly designed.</span>
            </button>
            <button type="button" class="option-btn-checkbox has-tooltip" data-field="partyInfo" data-value="reviews">
              <span class="checkbox-indicator">â˜</span>
              <span class="text-xl mr-2">â­</span> Online Reviews/Ratings
              <span class="tooltip">âœ“ Check Google, Facebook, forum. Look for detailed reviews, not just 5-stars with generic praise.</span>
            </button>
            <button type="button" class="option-btn-checkbox has-tooltip" data-field="partyInfo" data-value="bank-account">
              <span class="checkbox-indicator">â˜</span>
              <span class="text-xl mr-2">ğŸ¦</span> Bank Account Details
              <span class="tooltip">âœ“ Verify account name matches business/person. Be suspicious of personal accounts for business.</span>
            </button>
            <button type="button" class="option-btn-checkbox has-tooltip" data-field="partyInfo" data-value="minimal-info">
              <span class="checkbox-indicator">â˜</span>
              <span class="text-xl mr-2">â“</span> Very Little/No Information
              <span class="tooltip">ğŸš¨ MAJOR RED FLAG! Cannot verify who you're dealing with = extremely high scam risk. Don't proceed!</span>
            </button>
            <button type="button" class="option-btn-checkbox has-tooltip" data-field="partyInfo" data-value="not-started">
              <span class="checkbox-indicator">â˜</span>
              <span class="text-xl mr-2">ğŸ†•</span> Haven't Collected Info Yet
              <span class="tooltip">â„¹ï¸ If you're at the very beginning and haven't gathered information yet, select this. The tool will remind you what to collect.</span>
            </button>
          </div>
          <input type="hidden" name="partyInfo" required />
          
          <div id="info-partyInfo" class="info-box hidden mt-4 bg-indigo-900/20 border-l-4 border-indigo-500 p-4 rounded-r-lg">
            <div class="flex items-start">
              <svg class="w-6 h-6 text-indigo-400 mr-3 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
              </svg>
              <div class="flex-1">
                <h4 class="text-indigo-300 font-semibold mb-2">ğŸ’¡ Verification Tips</h4>
                <div id="info-content-partyInfo" class="text-gray-300 text-sm leading-relaxed">
                  <strong>The more verifiable information you have, the safer the transaction.</strong> Key verification steps:
                  <ul class="mt-2 space-y-1 list-disc list-inside">
                    <li><strong>SSM Check:</strong> Visit ssm.com.my to verify business registration</li>
                    <li><strong>Reverse Image Search:</strong> Check if profile photos are stolen</li>
                    <li><strong>Cross-Reference:</strong> Ensure all details match across platforms</li>
                    <li><strong>Independent Contact:</strong> Verify references through separate channels</li>
                    <li><strong>Physical Verification:</strong> Visit business location if claiming to have one</li>
                  </ul>
                  <p class="mt-2"><strong>Red Flag:</strong> If you selected "Very Little/No Information," this is extremely high risk. Don't proceed with the transaction!</p>
                </div>
              </div>
            </div>
          </div>
        </div>

      </form>

      <!-- Navigation Buttons (Fixed position below questions) -->
      <div id="navigationButtons" class="mt-8">
        <div class="flex justify-between items-center">
          <button 
            type="button"
            id="prevBtn"
            class="flex items-center bg-gray-700 text-white px-6 py-3 rounded-lg hover:bg-gray-600 transition-all font-semibold disabled:opacity-50 disabled:cursor-not-allowed"
          >
            <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
            </svg>
            Previous
          </button>
          
          <button 
            type="button"
            id="nextBtn"
            class="flex items-center bg-gradient-to-r from-indigo-600 to-purple-600 text-white px-6 py-3 rounded-lg hover:from-indigo-500 hover:to-purple-500 transition-all font-semibold disabled:opacity-50 disabled:cursor-not-allowed"
          >
            Next
            <svg class="w-5 h-5 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
            </svg>
          </button>

          <button 
            type="button"
            id="submitBtn"
            class="hidden flex items-center bg-gradient-to-r from-indigo-600 to-purple-600 text-white px-8 py-3 rounded-lg hover:from-indigo-500 hover:to-purple-500 transition-all font-semibold disabled:opacity-50 disabled:cursor-not-allowed shadow-lg hover:shadow-indigo-500/50"
          >
            <svg class="w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"/>
            </svg>
            Analyze Risk Level
          </button>
        </div>
      </div>

      <!-- Results Section (Hidden Initially) -->
      <div id="results" class="question-card mt-6" data-question="9">
        <div id="resultCard">
          <div class="text-center mb-4">
            <div id="riskBadge" class="inline-block px-4 py-2 rounded-full text-lg sm:text-xl font-bold mb-3"></div>
            <h2 class="text-2xl sm:text-3xl font-bold text-white mb-2">Risk Assessment</h2>
            <p id="riskScore" class="text-sm sm:text-base text-gray-400"></p>
          </div>
          
          <div id="riskExplanation" class="bg-gray-900/50 border border-gray-700 rounded-lg p-4 mb-4">
            <h3 class="text-base sm:text-lg font-semibold text-white mb-2 flex items-center">
              <svg class="w-5 h-5 mr-2 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
              </svg>
              Summary
            </h3>
            <p id="summaryText" class="text-gray-300 text-sm leading-relaxed"></p>
          </div>

          <div id="redFlags" class="bg-gray-900/50 border border-gray-700 rounded-lg p-4 mb-4">
            <h3 class="text-base sm:text-lg font-semibold text-white mb-2 flex items-center">
              <svg class="w-5 h-5 text-red-400 mr-2 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/>
              </svg>
              Red Flags
            </h3>
            <ul id="redFlagsList" class="space-y-1.5"></ul>
          </div>

          <div id="recommendations" class="bg-gray-900/50 border border-gray-700 rounded-lg p-4 mb-4">
            <h3 class="text-base sm:text-lg font-semibold text-white mb-2 flex items-center">
              <svg class="w-5 h-5 text-indigo-400 mr-2 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
              </svg>
              What To Do
            </h3>
            <ul id="recommendationsList" class="space-y-1.5"></ul>
          </div>

          <!-- Action Buttons Section -->
          <div id="actionButtons" class="space-y-3">
            <!-- Verify Contact Info (shown for all results) -->
            <div class="bg-indigo-900/20 border border-indigo-700/50 rounded-lg p-4">
              <h3 class="text-indigo-400 font-semibold text-sm sm:text-base mb-2 flex items-center">
                <svg class="w-5 h-5 mr-2 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                </svg>
                Verify Information
              </h3>
              <p class="text-gray-300 text-xs sm:text-sm mb-3">
                Check contact info against official Malaysian databases:
              </p>
              <div class="space-y-2">
                <a href="https://ccid.rmp.gov.my/semakmule" target="_blank" rel="noopener noreferrer" 
                   class="flex items-start text-xs sm:text-sm text-indigo-400 hover:text-indigo-300">
                  <span class="mr-2">ğŸ“±</span>
                  <span class="underline">CCID Scam Check</span>
                </a>
                <a href="https://www.bnm.gov.my/financial-consumer-alert-list" target="_blank" rel="noopener noreferrer" 
                   class="flex items-start text-xs sm:text-sm text-indigo-400 hover:text-indigo-300">
                  <span class="mr-2">ğŸ¦</span>
                  <span class="underline">Bank Negara Alert List</span>
                </a>
                <a href="https://www.sc.com.my/investor-alerts" target="_blank" rel="noopener noreferrer" 
                   class="flex items-start text-xs sm:text-sm text-indigo-400 hover:text-indigo-300">
                  <span class="mr-2">ğŸ“ˆ</span>
                  <span class="underline">SC Malaysia Investor Alerts</span>
                </a>
                <a href="https://www.ssm.com.my/Pages/eSearch.aspx" target="_blank" rel="noopener noreferrer" 
                   class="flex items-start text-xs sm:text-sm text-indigo-400 hover:text-indigo-300">
                  <span class="mr-2">ğŸ¢</span>
                  <span class="underline">SSM Business Search</span>
                </a>
              </div>
            </div>

            <!-- Action Buttons -->
            <div class="space-y-3">
              <!-- Main Actions -->
              <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                <button 
                  id="restartBtn"
                  type="button"
                  class="w-full bg-gradient-to-r from-indigo-600 to-purple-600 text-white px-6 py-3 rounded-lg hover:from-indigo-500 hover:to-purple-500 transition-all font-semibold shadow-lg hover:shadow-indigo-500/50"
                >
                  Check Another Transaction
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Share CTA -->
      <div class="bg-gradient-to-br from-gray-900/80 to-gray-800/80 border border-indigo-900/50 rounded-2xl p-6 mt-8 backdrop-blur-sm">
        <!-- Header -->
        <div class="text-center mb-4">
          <h3 class="text-lg font-bold text-white mb-1">Help Others Stay Safe</h3>
          <p class="text-sm text-gray-400">Share this tool to protect friends and family from scams</p>
        </div>

        <!-- Share Buttons -->
        <div class="flex flex-col items-center gap-3">
          <!-- Social Media Icons -->
          <div class="flex items-center gap-3 flex-wrap justify-center">
            <SocialShare
              buttons={[WhatsAppShareButton, FacebookShareButton, LinkedInShareButton, EmailShareButton, TwitterShareButton]}
              title="Universal Scam Checker - CyberBros"
              description="Check if a transaction is a scam before it's too late! Free scam detection tool for buyers, sellers, and investors."
            >
              <style slot="astro-social-share-css" is:global>
                .astro-social-share {
                  display: inline-flex;
                  gap: 0.75rem;
                  align-items: center;
                  flex-wrap: wrap;
                  justify-content: center;
                }

                .astro-social-share a.social-share-btn {
                  display: inline-flex;
                  align-items: center;
                  justify-content: center;
                  width: 2.75rem;
                  height: 2.75rem;
                  border-radius: 9999px;
                  background: rgba(75, 85, 99, 0.5);
                  transition: all 0.2s ease;
                  border: 1px solid rgba(99, 102, 241, 0.2);
                }

                .astro-social-share a.social-share-btn:hover {
                  transform: translateY(-2px);
                  background: rgba(99, 102, 241, 0.3);
                  border-color: rgba(99, 102, 241, 0.5);
                  box-shadow: 0 4px 12px rgba(99, 102, 241, 0.2);
                }

                .astro-social-share a.social-share-btn svg {
                  height: 1.25rem;
                  width: 1.25rem;
                  fill: currentColor;
                  color: #e5e7eb;
                }

                @media (max-width: 640px) {
                  .astro-social-share {
                    gap: 0.5rem;
                  }

                  .astro-social-share a.social-share-btn {
                    width: 2.5rem;
                    height: 2.5rem;
                  }
                  
                  .astro-social-share a.social-share-btn svg {
                    height: 1.125rem;
                    width: 1.125rem;
                  }
                }

                /* Copy Link Button - Match social share button styling */
                .copy-share-btn {
                  display: inline-flex;
                  align-items: center;
                  justify-content: center;
                  width: 2.75rem;
                  height: 2.75rem;
                  border-radius: 9999px;
                  background: rgba(75, 85, 99, 0.5);
                  transition: all 0.2s ease;
                  border: 1px solid rgba(99, 102, 241, 0.2);
                  color: #e5e7eb;
                  flex-shrink: 0;
                }

                .copy-share-btn:hover {
                  transform: translateY(-2px);
                  background: rgba(99, 102, 241, 0.3);
                  border-color: rgba(99, 102, 241, 0.5);
                  box-shadow: 0 4px 12px rgba(99, 102, 241, 0.2);
                }

                @media (max-width: 640px) {
                  .copy-share-btn {
                    width: 2.5rem;
                    height: 2.5rem;
                  }
                }
              </style>
            </SocialShare>
            
            <!-- Copy Link Button -->
            <button 
              type="button"
              id="copyShareLink"
              class="copy-share-btn"
              aria-label="Copy link"
              title="Copy link"
            >
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/>
              </svg>
            </button>
          </div>

          <!-- Feedback Message -->
          <p id="shareFeedback" role="status" aria-live="polite" class="hidden text-xs text-center text-indigo-300"></p>
        </div>
      </div>

    </div>
  </div>

  <style>
    /* Question card display control */
    .question-card {
      display: none;
      animation: slideInCard 0.5s ease-out;
    }

    .question-card.active {
      display: block;
    }

    @keyframes slideInCard {
      from {
        opacity: 0;
        transform: translateX(50px);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }

    .option-btn {
      background-color: rgb(31 41 55);
      border: 2px solid rgb(75 85 99);
      color: rgb(209 213 219);
      border-radius: 0.5rem;
      padding: 1rem;
      transition: all 0.3s;
      cursor: pointer;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
      font-weight: 500;
      position: relative;
    }
    
    .option-btn:hover {
      border-color: rgb(99 102 241);
      background-color: rgb(55 65 81);
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(99, 102, 241, 0.2);
    }
    
    .option-btn.selected {
      background-color: rgba(79, 70, 229, 0.2);
      border-color: rgb(99 102 241);
      color: white;
      box-shadow: 0 0 0 2px rgba(99, 102, 241, 0.5);
    }
    
    .option-btn.selected:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 16px rgba(99, 102, 241, 0.4), 0 0 0 2px rgba(99, 102, 241, 0.5);
    }
    
    .option-btn-full {
      background-color: rgb(31 41 55);
      border: 2px solid rgb(75 85 99);
      color: rgb(209 213 219);
      border-radius: 0.5rem;
      padding: 1rem 1.25rem;
      transition: all 0.3s;
      cursor: pointer;
      text-align: left;
      font-weight: 500;
      display: flex;
      align-items: center;
      position: relative;
    }
    
    .option-btn-full:hover {
      border-color: rgb(99 102 241);
      background-color: rgb(55 65 81);
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(99, 102, 241, 0.2);
    }
    
    .option-btn-full.selected {
      background-color: rgba(79, 70, 229, 0.2);
      border-color: rgb(99 102 241);
      color: white;
      box-shadow: 0 0 0 2px rgba(99, 102, 241, 0.5);
    }
    
    .option-btn-full.selected:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 16px rgba(99, 102, 241, 0.4), 0 0 0 2px rgba(99, 102, 241, 0.5);
    }

    /* Checkbox-style buttons for multi-select */
    .option-btn-checkbox {
      background-color: rgb(31 41 55);
      border: 2px solid rgb(75 85 99);
      color: rgb(209 213 219);
      border-radius: 0.5rem;
      padding: 1rem 1.25rem;
      transition: all 0.3s;
      cursor: pointer;
      text-align: left;
      font-weight: 500;
      display: flex;
      align-items: center;
      position: relative;
    }
    
    .option-btn-checkbox:hover {
      border-color: rgb(99 102 241);
      background-color: rgb(55 65 81);
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(99, 102, 241, 0.2);
    }
    
    .option-btn-checkbox.selected {
      background-color: rgba(79, 70, 229, 0.2);
      border-color: rgb(99 102 241);
      color: white;
      box-shadow: 0 0 0 2px rgba(99, 102, 241, 0.5);
    }
    
    .option-btn-checkbox .checkbox-indicator {
      font-size: 1.5rem;
      margin-right: 0.5rem;
      font-weight: bold;
    }
    
    .option-btn-checkbox.selected .checkbox-indicator {
      color: rgb(99 102 241);
    }

    /* Tooltip Styles */
    .has-tooltip .tooltip {
      visibility: hidden;
      opacity: 0;
      position: absolute;
      bottom: 100%;
      left: 50%;
      transform: translateX(-50%) translateY(-8px);
      background-color: rgb(17, 24, 39);
      color: rgb(243, 244, 246);
      padding: 0.75rem 1rem;
      border-radius: 0.5rem;
      font-size: 0.875rem;
      line-height: 1.4;
      white-space: normal;
      width: max-content;
      max-width: 280px;
      z-index: 1000;
      border: 1px solid rgb(99 102 241);
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5);
      transition: opacity 0.2s, visibility 0.2s, transform 0.2s;
      text-align: left;
      pointer-events: none;
    }

    .has-tooltip .tooltip::after {
      content: '';
      position: absolute;
      top: 100%;
      left: 50%;
      transform: translateX(-50%);
      border: 6px solid transparent;
      border-top-color: rgb(99 102 241);
    }

    .has-tooltip:hover .tooltip {
      visibility: visible;
      opacity: 1;
      transform: translateX(-50%) translateY(-12px);
    }

    @media (max-width: 768px) {
      .has-tooltip .tooltip {
        max-width: 220px;
        font-size: 0.8125rem;
      }
    }

    /* Info Box Animation */
    .info-box {
      animation: slideIn 0.4s ease-out;
    }

    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
  </style>

  <script>
    function getShareData() {
      const shareUrl = window.location.href.split('#')[0];
      return {
        title: 'Universal Scam Checker - CyberBros',
        text: 'Check if a transaction is a scam before it\'s too late! Free scam detection tool for buyers, sellers, and investors.',
        url: shareUrl
      };
    }

    // Flashcard navigation with conditional logic
    let currentQuestionIndex = 1;
    let visibleQuestions = [];
    let showingResults = false;

    // Determine which questions should be visible based on answers
    function getVisibleQuestions() {
      const situation = document.querySelector('input[name="situation"]')?.value;
      const redFlags = document.querySelector('input[name="redFlags"]')?.value || '';
      
      // Always show questions 1, 2, 8 (situation, red flags, info verification)
      const visible = [1, 2];
      
      // Q3: Communication Medium - show if NOT just checking
      if (situation && situation !== 'checking') {
        visible.push(3);
      }
      
      // Q4: Relationship Building - show if contacted, approached, group-added, or partnership
      if (situation && ['contacted', 'approached', 'group-added', 'partnership'].includes(situation)) {
        visible.push(4);
      }
      
      // Q5: Payment Method - always show (unless checking)
      if (situation && situation !== 'checking') {
        visible.push(5);
      }
      
      // Q6: Location - show if buying, selling, partnership, or approached in person
      // Also show if any meeting-related red flags are selected
      const meetingRedFlags = ['secluded-location', 'location-changing', 'sending-someone-else'];
      const hasMeetingRedFlag = meetingRedFlags.some(flag => redFlags.includes(flag));
      
      if (situation && (
        ['buying', 'selling', 'partnership', 'approached'].includes(situation) ||
        hasMeetingRedFlag
      )) {
        visible.push(6);
      }
      
      // Q7: Who Meeting - show if location is answered (except online-only)
      const location = document.querySelector('input[name="location"]')?.value;
      if (location && location !== 'online-only' && location !== 'not-applicable') {
        visible.push(7);
      }
      
      // Always show Q8 (information verification)
      visible.push(8);
      
      return visible.sort((a, b) => a - b);
    }

    function updateQuestionDisplay() {
      // If showing results, don't update question display
      if (showingResults) {
        return;
      }

      // Get visible questions based on answers
      visibleQuestions = getVisibleQuestions();
      const totalQuestions = visibleQuestions.length;

      // Hide all questions
      document.querySelectorAll('.question-card').forEach(card => {
        card.classList.remove('active');
      });

      // Show current question
      const currentCard = document.querySelector(`.question-card[data-question="${currentQuestionIndex}"]`);
      if (currentCard) {
        currentCard.classList.add('active');
      }

      // Update progress - show position in visible questions
      const currentPosition = visibleQuestions.indexOf(currentQuestionIndex) + 1;
      document.getElementById('currentQuestion').textContent = currentPosition || currentQuestionIndex;
      document.getElementById('totalQuestions').textContent = totalQuestions;
      const progressPercent = Math.round((currentPosition / totalQuestions) * 100);
      document.getElementById('progressPercent').textContent = progressPercent;
      document.getElementById('progressBar').style.width = `${progressPercent}%`;

      // Update button states
      const prevBtn = document.getElementById('prevBtn');
      const nextBtn = document.getElementById('nextBtn');
      const submitBtn = document.getElementById('submitBtn');

      prevBtn.disabled = currentQuestionIndex === 1;

      // Check if current question is answered
      const currentField = getCurrentFieldName();
      const isAnswered = document.querySelector(`input[name="${currentField}"]`)?.value;

      // Check if we're on the last visible question
      const isLastQuestion = currentQuestionIndex === visibleQuestions[visibleQuestions.length - 1];

      if (isLastQuestion) {
        nextBtn.classList.add('hidden');
        submitBtn.classList.remove('hidden');
        submitBtn.disabled = !isAnswered;
      } else {
        nextBtn.classList.remove('hidden');
        submitBtn.classList.add('hidden');
        nextBtn.disabled = !isAnswered;
      }
    }

    function getCurrentFieldName() {
      const fieldMap = {
        1: 'situation',
        2: 'redFlags',
        3: 'communicationMedium',
        4: 'relationshipBuilding',
        5: 'paymentMethod',
        6: 'location',
        7: 'whoMeeting',
        8: 'partyInfo'
      };
      return fieldMap[currentQuestionIndex];
    }

    function nextQuestion() {
      // Get visible questions
      visibleQuestions = getVisibleQuestions();
      
      // Find next visible question
      const currentIndex = visibleQuestions.indexOf(currentQuestionIndex);
      if (currentIndex < visibleQuestions.length - 1) {
        currentQuestionIndex = visibleQuestions[currentIndex + 1];
        updateQuestionDisplay();
        // Scroll to top of form smoothly
        document.getElementById('scamCheckerForm').scrollIntoView({ behavior: 'smooth', block: 'start' });
      }
    }

    function prevQuestion() {
      // Get visible questions
      visibleQuestions = getVisibleQuestions();
      
      // Find previous visible question
      const currentIndex = visibleQuestions.indexOf(currentQuestionIndex);
      if (currentIndex > 0) {
        currentQuestionIndex = visibleQuestions[currentIndex - 1];
        updateQuestionDisplay();
        document.getElementById('scamCheckerForm').scrollIntoView({ behavior: 'smooth', block: 'start' });
      }
    }

    // Educational content for each option
    const educationalContent = {
      situation: {
        'buying': '<strong>Buyer Scenario:</strong> When you initiate a purchase, your main risks include: Not receiving what you paid for, receiving fake/damaged goods, advance fee scams, overpayment scams. <strong>Protection:</strong> Use secure payment methods with buyer protection (credit card, marketplace platforms), verify seller legitimacy through reviews and registration, never send payment via gift cards or untraceable methods, request video calls for high-value items, meet in public places if possible.',
        'selling': '<strong>Seller Scenario:</strong> When receiving payment, your risks include: Fake payments (bounced checks, fake bank transfers), chargebacks after shipping, stolen credit cards, money laundering (being used as money mule). <strong>Protection:</strong> Verify payment has fully cleared before shipping, be cautious of overpayment requests, use COD or secure platforms, meet buyers in public places, document everything.',
        'contacted': '<strong>ğŸš¨ Unsolicited Contact - HIGH RISK:</strong> When someone contacts YOU with an offer, be extremely cautious. This is how most scams start. Common scenarios: Job offers, investment opportunities, business proposals, romance scams. <strong>Red flags:</strong> You didn\'t initiate contact, offer sounds too good to be true, pressure to act quickly, requests for personal info or money upfront. <strong>Action:</strong> Research thoroughly, verify independently, never share sensitive info, be skeptical of promises.',
        'approached': '<strong>ğŸš¨ In-Person Approach - CAUTION:</strong> Someone approaching you in public (street, coffee shop, mall) with an offer is unusual in Malaysia. Common scams: Fake charity, pyramid schemes, "help me transfer money" (money mule), fake surveys for prizes, gold/jewelry scams. <strong>Red flags:</strong> Stranger initiating business, emotional stories, urgency, asks you to help with banking/transfers. <strong>Action:</strong> Politely decline, don\'t share personal info, report suspicious behavior to authorities, trust your instincts - if it feels wrong, walk away.',
        'group-added': '<strong>ğŸš¨ CRITICAL - Group Investment Scam EPIDEMIC:</strong> Being added to WhatsApp/Telegram investment groups is THE most common scam in Malaysia 2024-2025! <strong>How it works:</strong> 1) Randomly added to group, 2) See "members" posting profit screenshots daily, 3) "Teacher/mentor" shares tips, 4) They send you small amount (RM50-200) as "proof", 5) Ask for larger deposit to "unlock" returns, 6) Money disappears forever. <strong>TRUTH:</strong> ALL group members are scammer-controlled fake accounts. Screenshots are fabricated. Initial payment is BAIT. <strong>Action:</strong> LEAVE GROUP immediately, block contacts, report to MCMC/PDRM, warn friends and family. This is 100% a scam - no exceptions!',
        'partnership': '<strong>Partnership/Collaboration:</strong> Business partnerships have unique risks since both parties contribute resources. <strong>Key protections:</strong> Get everything in writing with clear terms, verify partner\'s business registration with SSM, check their track record and references, use legal contracts reviewed by lawyer, understand profit-sharing clearly, establish dispute resolution process, be wary of requests for upfront capital without reciprocal investment. <strong>Red flags:</strong> Vague terms, all risk on your side, pressure to invest quickly, no legal documentation.',
        'checking': '<strong>Researching/Learning:</strong> Great that you\'re checking proactively! Even if you\'re just researching for someone else or learning about scam prevention, completing this assessment helps understand red flags. <strong>Key takeaway:</strong> Scammers appear very professional and trustworthy initially - that\'s how they succeed. Always verify independently, trust your instincts, and remember: if it sounds too good to be true, it always is. Share this tool with friends and family to help them stay safe!'
      },
      userRole: {
        'buyer': '<strong>Buyer/Receiver Risks:</strong> As someone paying for goods/services, your main risks include: Not receiving what you paid for, receiving fake/damaged goods, advance fee scams, overpayment scams (they send too much, ask for refund). Always use secure payment methods with buyer protection and verify seller legitimacy before paying.',
        'seller': '<strong>Seller/Provider Risks:</strong> As someone receiving payment, your main risks include: Fake payments (checks that bounce, fake bank transfers), chargebacks after shipping, stolen credit cards, money laundering (being used as money mule). Always verify payment has cleared before shipping goods and be cautious of overpayment requests.',
        'investor': '<strong>Investment/Money Opportunity Risks:</strong> These have the HIGHEST scam rate in Malaysia. Red flags include: Promises of guaranteed returns, pyramid/multi-level schemes, "get rich quick" claims, WhatsApp group "investment" schemes, forex/crypto trading "mentors", no legal registration. If it sounds too good to be true, it always is. Most are Ponzi schemes where early investors are paid with new investors\' money.',
        'partimer': '<strong>Part-time Job Scam Alert:</strong> Malaysia sees many fake part-time job scams. Red flags: Promises of easy money for simple tasks, requires upfront "registration fee" or "training deposit", work-from-home data entry jobs, repackaging/forwarding goods (money mule), WhatsApp job offers from strangers. Legitimate part-time jobs don\'t require payment from you!',
        'worker': '<strong>Employment Scam Warning:</strong> Fake job offers are common. Red flags: Job offer without interview, requires payment for "visa processing" or "equipment", salary too good for qualifications, offers from free email addresses, vague job descriptions. Always verify company registration with SSM and check reviews from current/past employees.',
        'exchange': '<strong>Exchange Transaction:</strong> Both parties exchanging value (barter, trade, partnership). Risks for both sides exist. Ensure: Clear agreement on what each party provides, written contract, simultaneous exchange or use escrow, verify the other party\'s legitimacy, understand legal implications of the exchange.',
        'not-sure': '<strong>Early Stage or Unsure:</strong> If you\'re in early conversations or just gathering information, that\'s normal. However, understand that <strong>scammers often appear very professional, kind, and helpful in the early stages</strong> - this is called the "grooming phase" where they build trust before making their move. During this phase, they may: 1) Chat casually without asking for money, 2) Seem very patient and understanding, 3) Share personal stories to build connection, 4) Offer valuable advice or help, 5) Be overly friendly or complimentary. <strong>This is intentional strategy</strong> - they\'re building trust so you\'ll lower your guard later. The fact that everything seems "too nice" or "no red flags yet" doesn\'t mean it\'s safe - you simply may not have reached the scam stage yet. Stay alert even during friendly early conversations and continue through all questions to assess risk.'
      },
      location: {
        'online-only': '<strong>Online Transaction Safety:</strong> Many legitimate businesses operate online. However, verify: Website is secure (HTTPS/padlock icon), use marketplace platforms with buyer protection (Shopee, Lazada), check seller reviews and ratings, use secure payment methods, be extra cautious with social media sellers. For high-value items, consider meeting in person or using escrow services.',
        'public-place': '<strong>Meeting in Public Places:</strong> This is the SAFEST option for in-person transactions in Malaysia. Recommended locations: Shopping mall food courts, bank lobbies, police station parking lots, 24-hour McDonald\'s/KFC, busy coffee shops. Advantages: CCTV cameras, witnesses, security guards, safe environment. For expensive items (phones, laptops, cars), some police stations allow transaction meetups.',
        'street-public': '<strong>Street/Public Area Caution:</strong> Meeting on streets or outdoor public areas has moderate risk. <strong>If approached in public:</strong> This is often how scammers initiate - fake charity, pyramid schemes, "help me transfer money" (money mule). Request business cards and verify company. <strong>If arranging a street meeting:</strong> Choose busy, well-lit areas with CCTV, bring someone with you, daytime only, share your location with family/friends. Police station parking or bank entrances are better alternatives.',
        'office-business': '<strong>Business Location Verification:</strong> Visiting their office is a good sign of legitimacy. However, verify first: Google the address (check Street View), call to confirm it\'s their actual office (not serviced office for show), check if company name is displayed, verify with building management if needed. Scammers sometimes use fake "offices" or short-term rentals. Still meet during business hours and bring someone with you.',
        'private-residence': '<strong>Private Residence Risks:</strong> Meeting at private homes carries risks: No witnesses, no security cameras, personal safety concerns, difficult to verify identity. ONLY meet at residences if: You know the person well, bringing a friend/family member, daytime meeting, transaction is low-value, you\'ve shared location with someone. NEVER go alone for expensive items or first-time meetups. Consider suggesting a public alternative.',
        'secluded-area': '<strong>ğŸš¨ EXTREME DANGER:</strong> Legitimate businesses NEVER suggest secluded locations. This is a major warning sign for: Robbery setup, personal safety threat, kidnapping risk, crime in progress. Common scam: "My house is far, let\'s meet halfway at this deserted area." DO NOT PROCEED! If they insist on secluded location, report to police (997 or CCID at 03-2610 1559). Your safety is more important than any deal.',
        'keeps-changing': '<strong>Changing Location Red Flag:</strong> Constantly changing meeting locations indicates: Scammer trying to confuse you, avoiding areas with CCTV/witnesses, testing your compliance, disorganized fraud operation. Legitimate sellers have no reason to keep changing locations. This suggests they\'re not committed to the transaction or planning something suspicious. Demand a fixed public location or walk away.',
        'refuses-specify': '<strong>Location Secrecy Warning:</strong> Refusal to specify meeting location means: They don\'t have a real business, hiding identity or location, planning to scam and disappear, testing if you\'ll accept poor transparency. For online-only businesses, they should still provide registered business address. Any legitimate party will clearly state where business occurs. If they\'re vague, don\'t proceed.',
        'not-applicable': '<strong>Location Not Discussed Yet:</strong> If you haven\'t discussed meeting location yet, that\'s normal for early conversations when scammers are still building trust. However, this becomes important to establish as things progress. Watch for these red flags when you DO discuss location: Avoiding the question or being vague, suggesting unusual/secluded locations, constantly changing locations, refusing to specify, getting defensive when asked, always having excuses. Legitimate parties are transparent about meeting arrangements from the start - they have nothing to hide.'
      },
      whoMeeting: {
        'person-directly': '<strong>Direct Contact - Best Scenario:</strong> Meeting the person you\'ve been communicating with provides the best accountability. This is the ideal scenario because: They can\'t deny involvement later, you can verify their identity matches communications (photo, voice, etc.), direct accountability makes scams less likely. Still verify their identity: Request IC/business card, compare face with social media profiles, confirm phone number matches, get written documentation of transaction. Even with direct contact, follow standard safety precautions.',
        'authorized-representative': '<strong>Authorized Representatives are Normal:</strong> For established businesses, dealing with authorized representatives is standard practice. However, proper verification is essential: 1) Request authorization letter on company letterhead specifying their authority, 2) Call the company directly using publicly listed number (not number they provide) to confirm employment, 3) Check employee on LinkedIn or company website, 4) Meet at company office when possible, 5) Get direct contact of their supervisor. Legitimate companies will readily provide all this information.',
        'sending-someone-else': '<strong>ğŸš¨ CRITICAL RED FLAG - Sending Someone Else:</strong> When the person you\'ve been dealing with sends a "friend" or "family member" instead of coming themselves, this is a MAJOR warning sign in Malaysia. Why this is extremely suspicious: 1) <strong>Avoiding Identity Verification</strong> - Scammers don\'t want you to see their real face/identity, 2) <strong>Robbery Setup</strong> - Common tactic: "friend" robs you or takes item without paying, 3) <strong>Deniability</strong> - If caught, they claim "my friend acted alone", 4) <strong>Multiple Scam Accounts</strong> - One person manages multiple fake accounts. <strong>Common excuses:</strong> "I\'m busy at work", "I\'m outstation", "My friend is closer to you". <strong>Action:</strong> INSIST they come personally or do video call first. If they refuse, WALK AWAY - 95% scam probability. Legitimate sellers have no problem meeting personally for their own business.',
        'courier-delivery': '<strong>Courier/Delivery Services - Verify First:</strong> Using professional courier services (J&T, Poslaju, DHL, etc.) is normal for e-commerce but has risks: <strong>Legitimate scenario:</strong> Established online seller with good reviews shipping via reputable courier, tracking number provided, can verify with courier company, marketplace platform involved (Shopee, Lazada). <strong>Scam scenarios:</strong> COD parcel scam (damaged/fake items inside), empty box scam, fake courier (scammer dresses as delivery person), overpayment refund scam. <strong>Protection:</strong> Open and inspect items BEFORE signing/paying, record unboxing video, use marketplace platforms with buyer protection, verify courier tracking is real, never pay extra fees to "courier" in cash.',
        'unclear-evasive': '<strong>ğŸš¨ EXTREME WARNING - Being Evasive:</strong> If they refuse to clearly state who will meet you or keep avoiding the question, this is a CRITICAL red flag indicating: 1) <strong>No Real Person Exists</strong> - It\'s a fake identity/stolen profile, they can\'t meet because they\'re not who they claim, 2) <strong>Overseas Scam Operation</strong> - They\'re in another country running the scam, 3) <strong>Planning Something Malicious</strong> - Robbery, kidnapping, or other criminal activity, 4) <strong>Constantly Changing Story</strong> - Sign of disorganized scam operation. <strong>Legitimate parties are ALWAYS transparent about:</strong> Who will represent them, Their authorization/role, Contact details of the person meeting. <strong>If they\'re evasive:</strong> STOP ALL COMMUNICATION immediately, report to authorities if threatened, block all contact. This is 99% a scam - do not proceed under any circumstances.',
        'online-no-meeting': '<strong>Online-Only Transactions:</strong> Many legitimate businesses operate entirely online. This is acceptable IF proper precautions are taken: <strong>For high-value items (>RM500):</strong> Request video call verification, use escrow services, use marketplace platforms with buyer protection, verify business registration with SSM. <strong>For any online transaction:</strong> Check extensive reviews from multiple sources, verify website/social media age and activity, use secure payment methods (credit card with chargeback protection), never use gift cards/cryptocurrency for purchases, keep all communication records. <strong>Red flags in online-only:</strong> Refuses video call for expensive items, no verifiable business presence, only accepts irreversible payment methods, pressure to buy immediately.',
        'not-applicable': '<strong>Early Stage Transaction:</strong> If you haven\'t discussed meeting arrangements yet, that\'s normal for early conversations. However, when you DO discuss meeting: 1) Pay attention to their willingness to meet, 2) Watch for evasive behavior about who will meet, 3) Insist on meeting the person you\'ve been communicating with, 4) Request video call before any in-person meeting, 5) Set meeting in public place during daytime. Use this conversation as an opportunity to assess their legitimacy - how they respond to meeting requests reveals a lot about their intentions.'
      },
      communicationMedium: {
        'email': '<strong>Email Communication Security:</strong> Email is professional standard but vulnerabilities exist: Check sender domain carefully (maybank.com.my vs maybenk.com), look for SPF/DKIM authentication, hover over links before clicking, never download unexpected attachments, call company directly to verify important requests. In Malaysia, business email compromise (BEC) scams cost companies millions annually. Always verify payment instructions through separate channel.',
        'sms': '<strong>SMS/Smishing Scams:</strong> SMS is rarely used by legitimate businesses for transactions in Malaysia. Common SMS scams: Fake delivery notifications, prize winnings, bank alerts, government messages. Red flags: Shortened URLs, urgent action required, threats, asking for personal info. NEVER click links in unexpected SMS. Malaysian banks/government will NEVER ask for OTP, password, or IC details via SMS.',
        'whatsapp': '<strong>WhatsApp Business Risks:</strong> WhatsApp is common in Malaysia but has risks: Account hijacking is frequent, easy to fake identity, no official verification for most accounts, messages can be from anyone. Safety measures: Verify phone number independently, check if they have WhatsApp Business account (shows business details), video call to confirm identity, save and backup all chats, be suspicious of number changes.',
        'whatsapp-group': '<strong>ğŸš¨ WhatsApp Group Scam EPIDEMIC:</strong> This is THE most common scam in Malaysia 2024-2025! The pattern: 1) Random add to "investment" group, 2) Fake members show profits daily, 3) "Teacher/mentor" shares trading tips, 4) They send you small amount first (RM50-200) as "proof", 5) Ask you to deposit larger amount to "unlock" bigger returns, 6) Once you deposit, money gone forever. ALL group members are scammer-controlled accounts. The initial small payment is BAIT. Report group to MCMC/PDRM immediately and leave!',
        'telegram': '<strong>Telegram Scam Awareness:</strong> Telegram offers privacy but that attracts scammers: Crypto scams thrive on Telegram, fake investment "communities", impersonator bots, no way to verify real identity easily. Be extra cautious: Verify person through other platforms, scammers love Telegram\'s anonymity, check if account is recently created, never join investment/trading groups from strangers. Legitimate businesses prefer more traceable platforms.',
        'social-media': '<strong>Social Media Transaction Safety:</strong> Facebook Marketplace, Instagram shops are popular but risky: Fake business pages are common, easy to create fake accounts, clone real business pages, no transaction protection. Verify authenticity: Check page creation date, look for blue verification badge, check follower engagement (not just numbers), search company name + scam online, contact through official website if exists. Use marketplace platform with buyer protection when possible.',
        'phone-call': '<strong>Phone Call Verification:</strong> Phone is professional but has risks in Malaysia: Caller ID spoofing is easy (scammers display fake bank/police numbers), voice phishing (vishing) is common, threats and urgency over phone. Protection: NEVER give OTP, password, or IC over phone, call back using publicly listed numbers (not the number that called you), verify caller identity through separate means, hang up if pressured. Malaysian banks/government will NEVER threaten arrest or demand immediate payment over phone.',
        'video-call': '<strong>Video Call Verification:</strong> Video call is excellent for identity verification: Harder to fake face-to-face interaction, can request to see ID on camera, observe body language and environment, build trust for remote transactions. Best practices: Record the call (inform them first), ask them to show physical documents, verify background matches claimed location, ask unexpected questions to test authenticity. However, deep fakes exist - for very high-value deals, combine video with other verification.',
        'business-platform': '<strong>Professional Platform Benefits:</strong> LinkedIn and similar platforms offer advantages: Some identity verification by platform, professional history visible, connections can vouch for person, harder to create completely fake profile. However, still verify: Check how long account exists, look for consistent activity history, verify connections are real people, cross-check information with other sources. Scammers do create fake LinkedIn profiles, especially for employment scams.',
        'marketplace': '<strong>Marketplace Platform Safety:</strong> Shopee, Lazada, Carousell offer best protection: Built-in buyer protection, money held in escrow until delivery confirmed, rating systems help identify reliable sellers, platform mediates disputes, seller verification processes. This is SAFEST way to buy/sell in Malaysia. Red flag: If seller asks to complete transaction outside platform to "save fees" - that\'s how they bypass protection. Never agree to off-platform payment!',
        'in-person-only': '<strong>In-Person Only Communication:</strong> Meeting only face-to-face without digital communication has both advantages and risks. <strong>Advantages:</strong> Direct identity verification, harder to maintain fake identity long-term, can assess body language and trustworthiness in person. <strong>Risks:</strong> No digital paper trail for legal recourse, personal safety concerns if meeting locations aren\'t safe, harder to verify claims independently without online presence. <strong>Best practices:</strong> Always meet in public places (mall, bank lobby, police station for high-value items), bring someone with you, verify ID during meeting, get written receipts/documentation even for cash transactions, trust your instincts about the person. If they approached you on the street with an offer, be extra cautious - verify everything they claim.',
        'not-started': '<strong>Communication Not Started or Very Early:</strong> If you haven\'t begun communicating or just started, remember that <strong>scammers are often very friendly, professional, and helpful initially</strong>. They use this "honeymoon phase" to establish trust before revealing their true intentions. Early conversations may seem perfectly normal - that\'s intentional. As you communicate, pay attention to: HOW they initiated contact (unsolicited?), which platform they prefer (anonymous?), if they try moving to less secure platforms, reluctance for video calls, insistence on specific methods only. The fact that early communication seems "nice" doesn\'t mean it\'s safe - just means you may be in the trust-building stage.'
      },
      socialEngineering: {
        'urgency': '<strong>Urgency Pressure Tactic:</strong> "Limited time offer!", "Expires in 1 hour!", "Act now or lose this deal!" - These create artificial urgency to bypass your rational thinking. Scammers know that rushed decisions skip due diligence. In Malaysia, Macau Scams use extreme urgency ("Police will arrest you in 2 hours!"). LEGITIMATE BUSINESSES respect your need for time. If they pressure immediate action, it\'s almost certainly a scam. Take your time - good deals will still be there tomorrow.',
        'fear': '<strong>Fear and Intimidation:</strong> "Your account will be frozen!", "Police warrant issued!", "Legal action within 24 hours!" - Fear paralyzes logical thinking. Common in Malaysia: Fake LHDN (tax) calls, fake police calls, fake bank fraud alerts. REMEMBER: Real authorities send official letters first, never threaten over phone/WhatsApp, will NEVER ask for money or personal details over phone. If threatened, hang up and call the organization directly using publicly listed numbers.',
        'scarcity': '<strong>Artificial Scarcity:</strong> "Only 2 units left!", "Last chance!", "5 people viewing this now!" - Creates false competition pressure. Online sellers often fake scarcity to rush decisions. Test: Ask specific questions about the item - scammers get defensive or vague. Check if "limited stock" claim is real - search for same item elsewhere. Legitimate limited editions exist, but scammers abuse this tactic. Take time to verify before committing.',
        'authority': '<strong>Authority Impersonation:</strong> Malaysia has EPIDEMIC of authority impersonation scams: Fake PDRM (police), fake Bank Negara, fake LHDN (tax), fake court officers, fake MACC (anti-corruption). They use: Official-sounding language, display spoofed official numbers, send fake documents, threaten legal consequences. VERIFICATION: All legitimate government/bank contact starts with official letters, real authorities have officer ID numbers you can verify, call back using numbers from official websites (not numbers they provide). Report impersonation to CCID at 997.',
        'too-good': '<strong>"Too Good to Be True" Hook:</strong> Property 50% below market, investment returning 20% monthly, luxury goods at 70% discount, job with RM8k salary for minimal work. This is THE #1 scam psychology - the bait that hooks victims. Ask yourself: Why would they offer ME this amazing deal? What\'s preventing everyone from taking it? If it sounds impossible, it IS impossible. Legitimate good deals exist but have logical explanations. Scammers rely on greed overriding common sense. Research market rates thoroughly.',
        'social-proof': '<strong>Fake Social Proof:</strong> WhatsApp groups with "members" showing profits, testimonial screenshots, fake reviews, "limited slots" claims. The truth: ALL those "members" are scammer-controlled accounts or previous victims being used. Screenshots are easily faked (inspect element in browser). The small amount they pay you first is BAIT to hook larger payment. Real social proof: Independent reviews on Google/Facebook, meet actual customers, check with authorities if investment is registered. If social proof only exists within their controlled environment, it\'s fake.',
        'reciprocity': '<strong>Reciprocity Trap:</strong> They give you small gift/payment first, making you feel obligated to reciprocate. Psychology: Humans naturally want to return favors. Scammer version: Pay you RM100 first to "prove" legitimacy, then ask for RM1000+ investment. Send small order successfully, then scam on large order. The small amount is investment in the scam - they lose RM100 to gain RM1000+. Don\'t feel obligated! That small payment doesn\'t prove anything about larger transaction. Each transaction stands on its own merits.',
        'sympathy': '<strong>Sympathy and Emotional Manipulation:</strong> Romance scams, sob stories, fake emergencies, appeals to charity. They build emotional connection to cloud judgment: "My mother is sick, need money urgently", "I love you, just help with this one thing", "Fellow Muslim/Christian brother needs help". Real red flags: Business mixed with emotions, sob story that gets increasingly dramatic, resistant to verification ("Don\'t you trust me?"). Legitimate business is TRANSACTIONAL, not emotional. Separate your emotions from financial decisions. Helping people is good - but verify legitimacy first!',
        'none': '<strong>Professional Approach:</strong> No manipulation, no pressure, no emotional appeals - just professional business conduct. This is how legitimate businesses operate: They present information clearly, give you time to decide, answer questions honestly, respect if you decline, don\'t create false urgency, provide verifiable facts. They understand good business comes from satisfied customers, not manipulation. However, absence of pressure tactics doesn\'t automatically mean legitimate - still verify all other factors. But this is definitely a positive indicator!',
        'not-sure': '<strong>Too Early to Assess Pressure Tactics:</strong> If you haven\'t had enough interaction to assess pressure tactics yet, that\'s normal for early conversations. <strong>Important:</strong> Scammers are often very kind, patient, and professional in the early "grooming phase" - building trust before applying pressure later. The absence of pressure tactics NOW doesn\'t mean they won\'t appear later. Stay alert for sudden changes: Urgency appearing out of nowhere, emotional manipulation starting, threats or fear tactics emerging, too-good-to-be-true offers suddenly presented. Legitimate businesses maintain consistent professionalism throughout. Any sudden dramatic change in tone or pressure is a major red flag.'
      },
      paymentMethod: {
        'gift-cards': '<strong>Gift Card Scams:</strong> This is the #1 payment method for scammers. No legitimate business will EVER ask for payment via gift cards (iTunes, Google Play, Steam, etc.). Once you provide the codes, your money is gone forever with zero recourse. In Malaysia, this tactic is used in phone scams where fraudsters impersonate government officials or banks.',
        'cryptocurrency': '<strong>Cryptocurrency Risks:</strong> Crypto transactions are irreversible and mostly untraceable. Scammers love crypto because victims cannot get refunds. In Malaysia, many investment scams (like fake "Macau Scams") now request crypto payments. Only use crypto with parties you completely trust.',
        'wire-transfer': '<strong>Wire Transfer Dangers:</strong> Wire transfers (Western Union, MoneyGram) are nearly impossible to reverse. Business Email Compromise (BEC) scams often trick companies into wiring money to fraudulent accounts. Always verify recipient details through a separate communication channel.',
        'bank-transfer': '<strong>Bank Transfer Safety:</strong> Local bank transfers (like FPX, online banking) offer some protection in Malaysia. However, verify the account holder name matches the business. Be wary of personal accounts for business transactions. Banks can sometimes help recover funds if fraud is reported quickly.',
        'check': '<strong>Check Scam Alert:</strong> In Malaysia, checks take 2-3 business days to clear. Scammers exploit this by having you ship goods or transfer money before the check bounces. Even if money appears in your account initially, the bank can reverse it days later. Common in overpayment scams where the scammer "accidentally" overpays and asks for a refund.',
        'cod': '<strong>Cash on Delivery:</strong> The safest for in-person transactions. Meet in public places like malls or bank lobbies. For valuable items, consider meeting at a police station. Inspect items thoroughly before paying. Never agree to COD at private locations.',
        'credit-card': '<strong>Credit Card Protection:</strong> Credit cards offer the best buyer protection in Malaysia. You can dispute charges (chargeback) if goods aren\'t delivered or are fraudulent. However, never share your CVV, PIN, or OTP codes - banks will NEVER ask for these.',
        'escrow': '<strong>Escrow Services:</strong> Escrow holds funds until both parties fulfill their obligations. Ideal for large transactions (property, vehicles, expensive equipment). In Malaysia, use licensed escrow services. Verify the escrow company is legitimate - scammers create fake escrow sites.',
        'money-order': '<strong>Money Order Risks:</strong> Similar to checks - they can be counterfeited. Takes days to verify authenticity. The overpayment scam commonly uses fake money orders. Banks may initially accept them, then reverse payment when fraud is discovered.',
        'not-discussed': '<strong>Payment Method Not Discussed Yet:</strong> In early conversations, scammers often avoid discussing payment to keep you engaged. They want to build trust first. Before proceeding further, you should clarify the payment method - this is CRITICAL information for assessing scam risk. Watch for these red flags when you DO discuss payment: They avoid or deflect payment questions, keep changing payment methods, suggest unusual payment methods (gift cards, crypto), want to discuss it "later" repeatedly, get defensive when asked. Legitimate businesses are transparent about payment terms from the start.'
      },
      timeline: {
        'immediate': '<strong>The Urgency Tactic:</strong> Scammers create artificial urgency to prevent rational thinking. Phrases like "offer expires in 1 hour" or "act now or lose money" are manipulation tactics. Legitimate businesses respect your need for due diligence. In Malaysia, Macau Scam operators use extreme urgency, claiming police will arrest you within hours if you don\'t pay.',
        'same-day': '<strong>Pressure to Rush:</strong> Same-day deadlines don\'t allow proper verification. Red flag if combined with high-value transactions. Professional businesses understand that major decisions require time for consultation, legal review, and background checks.',
        'few-days': '<strong>Limited Time Frame:</strong> A few days is better but still restrictive for complex transactions. Use this time wisely: verify credentials, check company registration with SSM (Malaysia\'s business registry), read reviews, and consult professionals if needed.',
        'week': '<strong>Reasonable Timeline:</strong> A week allows proper due diligence for most transactions. Use this time to: verify business registration, check references, review contracts carefully, and research the company\'s reputation online.',
        'flexible': '<strong>No Pressure = Good Sign:</strong> Legitimate businesses are confident in their offerings and don\'t use pressure tactics. Flexibility shows professionalism and respect for your decision-making process. Take your time to research thoroughly.'
      },
      contactMethod: {
        'unsolicited-email': '<strong>Email Scam Awareness:</strong> Phishing emails are extremely common in Malaysia. Check for: misspelled domains (e.g., "maybenk.com" instead of "maybank.com"), generic greetings, urgent threats, suspicious links. Hover over links before clicking. Call the company directly using publicly listed numbers to verify.',
        'unsolicited-call': '<strong>Phone Scam Warning:</strong> Cold calls for business deals are rare. The "Macau Scam" in Malaysia uses unsolicited calls with caller ID spoofing to impersonate police, banks, or government agencies. Never give personal info over the phone. Hang up and call back using official numbers.',
        'sms': '<strong>SMS Phishing (Smishing):</strong> Legitimate businesses rarely initiate business deals via SMS. Common in Malaysia: fake bank alerts, delivery notifications with malicious links, or prize winnings. Never click links in unexpected SMS messages. Verify through official channels.',
        'whatsapp-group': '<strong>ğŸš¨ WhatsApp Group Scam ALERT:</strong> This is one of the MOST COMMON scams in Malaysia! The pattern: 1) Added to group showing "members" making money, 2) Admin shows "proof" of successful transactions (all fake screenshots), 3) They send you small amount first (RM50-200) to build trust, 4) Ask you to pay "advance fee" or "deposit" to unlock bigger returns, 5) Once you pay, you never see money again. ALL group members are fake accounts controlled by scammers or previous victims they\'re using. The initial small payment is the bait. NEVER join investment/money-making WhatsApp groups from strangers. 100% scam rate. Report and leave immediately.',
        'social-media': '<strong>Social Media Verification:</strong> Fake business profiles are common on Facebook, Instagram, WhatsApp. Verify the blue checkmark for official accounts. Scammers clone legitimate business pages. Always verify through the company\'s official website before transacting.',
        'business-platform': '<strong>LinkedIn & Professional Platforms:</strong> While more legitimate, scammers use fake profiles even here. Check the person\'s connections, endorsements, activity history, and years on platform. Message mutual connections to verify identity.',
        'referral': '<strong>Verify Referrals:</strong> Contact the person who referred you through a known channel (not the contact info provided by the new party). Scammers impersonate acquaintances. In Malaysia, WhatsApp account hijacking is common - always verify with a phone call.',
        'company-website': '<strong>Website Verification:</strong> Check domain age (use whois lookup), look for contact info, verify SSL certificate (padlock icon), check for professional design and grammar. Scam sites are often new and poorly made. Cross-reference contact info with SSM records.'
      },
      emailDomain: {
        'free-email': '<strong>Free Email Red Flag:</strong> Established businesses in Malaysia invest in professional email (e.g., name@company.com.my). Using Gmail/Yahoo suggests: 1) Not a registered business, 2) Trying to hide identity, 3) Temporary operation. Exceptions: very small startups or sole proprietors, but verify thoroughly. Ask why they don\'t have company email.',
        'suspicious': '<strong>Typosquatting Attack:</strong> Scammers register domains similar to legitimate ones (maybenk.com vs maybank.com.my, cimb.com.com). Always verify exact spelling. In Malaysia, legitimate companies use .com.my or .my domains. Check: letter substitution (rn vs m), extra letters, wrong extensions (.com vs .com.my). Report suspicious domains to CyberSecurity Malaysia.',
        'new-domain': '<strong>Domain Age Matters:</strong> You can check domain age at whois.domaintools.com. Scammers create new domains because: 1) Old scam domains get blacklisted, 2) They abandon sites after scamming. Red flags: Domain less than 6 months old + high-value deal + pressure to act fast. Legitimate businesses have established domains.',
        'company-domain': '<strong>Verify Company Domains:</strong> Even with company domains, verify: 1) Visit their official website directly (don\'t click email links), 2) Compare email address with website contact page, 3) Check SSM (Companies Commission of Malaysia) for business registration, 4) Call the company using publicly listed numbers to confirm the person exists. Email spoofing is possible.',
        'no-email': '<strong>No Email = Major Warning:</strong> Every legitimate business has email in 2025. Operating without email suggests: 1) Deliberately hiding identity, 2) Planning to disappear, 3) Not a real business. This is especially suspicious in Malaysia where even small businesses use email. Only communicate via phone/WhatsApp is a massive red flag.'
      },
      dealQuality: {
        'too-good': '<strong>"Too Good to Be True" Rule:</strong> This is the #1 psychological hook scammers use. Examples in Malaysia: Properties 50% below market, investment returns of 20%/month, luxury goods at 70% off, job offers with huge salaries for minimal work. The scammer creates urgency around the "amazing deal" so you don\'t think rationally. Always ask: Why would they offer ME this deal? What\'s the catch? Research market rates thoroughly.',
        'better': '<strong>Better Pricing - Verify Why:</strong> Legitimate reasons for better pricing: Bulk purchase discounts, end-of-season sales, company liquidation, damaged packaging. Ask for explanation. Be wary if combined with urgency or requests for unusual payment methods. In Malaysia, compare with prices on Lazada, Shopee, or official retailers.',
        'market-rate': '<strong>Fair Market Pricing:</strong> At-market pricing is a positive indicator of legitimate business. Research current rates: Check Mudah.my for property/vehicles, compare prices across multiple sellers, consult industry price guides. Scammers sometimes use market rates but combine it with other red flags (pressure, suspicious payment methods).',
        'slightly-worse': '<strong>Higher Than Market:</strong> Sometimes legitimate for: Premium service, specialized expertise, convenience fees, authorized dealers with warranty. However, if significantly overpriced + aggressive sales tactics, it could be a pressure scam. Always compare multiple quotes before deciding.'
      },
      documentation: {
        'refuses': '<strong>No Documentation = No Deal:</strong> In Malaysia, legitimate transactions require documentation: Sales agreements, invoices, receipts, contracts. Refusing documentation means: 1) No legal recourse if scammed, 2) Can\'t prove transaction occurred, 3) Likely fraud. Even small transactions should have receipts. Walk away immediately if they refuse formal documentation.',
        'vague': '<strong>Watch for Vague Documents:</strong> Red flags in documents: Missing company registration number (SSM), vague terms and conditions, spelling errors, mismatched names/addresses, missing contact information, no signatures or stamps. Professional documents have: Clear terms, legal company details, specific amounts and dates, proper formatting. Have documents reviewed by a lawyer for large transactions.',
        'willing': '<strong>Review Documents Thoroughly:</strong> When they provide documentation: 1) Verify company details with SSM database (Companies Commission of Malaysia), 2) Check if addresses/phone numbers match official records, 3) Look for revision history or metadata in digital docs, 4) Compare with standard industry contracts, 5) Take time to read everything before signing - don\'t be pressured.',
        'professional': '<strong>Professional Contracts Are Essential:</strong> Good contracts include: Clear parties identification (IC/Registration #), specific terms and conditions, payment schedules, delivery timelines, dispute resolution procedures, governing law (usually Malaysian law), signatures and dates, witness signatures for large amounts. In Malaysia, stamping may be required for certain agreements.'
      },
      verification: {
        'no-info': '<strong>No Verification = Huge Risk:</strong> In Malaysia, verify businesses through: 1) <strong>SSM (Companies Commission of Malaysia)</strong> - search company registration at ssm.com.my, 2) Google the business name and check for reviews/complaints, 3) Check if address is real (use Google Maps Street View), 4) Verify phone numbers match official listings. Cannot verify identity? Don\'t transact. It\'s that simple.',
        'inconsistent': '<strong>Inconsistent Information Alert:</strong> Red flags: Name spelling changes, different addresses in documents vs website, phone numbers don\'t match, person\'s role keeps changing, business name variations. Scammers create fake identities with inconsistencies. Test them: Ask the same question twice in different ways, check if stories align, verify details independently.',
        'minimal': '<strong>Limited Digital Footprint:</strong> New businesses may have minimal presence, but should still have: Basic website or social media, some Google results, contact information. Be extra cautious with: No reviews anywhere, can\'t find any information online, social media created very recently, no physical address. Request additional verification for substantial transactions.',
        'verified': '<strong>How to Verify Properly:</strong> Verification checklist: âœ“ SSM registration confirmed, âœ“ Website matches business details, âœ“ Address verified (if physical location, visit or Google Street View), âœ“ Phone number from independent source, âœ“ Reviews on multiple platforms (Google, Facebook), âœ“ Social media has activity history (not just created), âœ“ Business email domain matches website.',
        'established': '<strong>Established Business Benefits:</strong> Companies with long history offer: 1) More accountability - can\'t easily disappear, 2) Verifiable track record, 3) Assets/reputation at stake, 4) Better legal recourse if issues arise. Check how long in business via SSM registration date, check news articles/press releases, look for awards or industry recognition. Still be vigilant - even established companies have fraudulent employees.'
      },
      communication: {
        'poor': '<strong>Poor Communication Warning:</strong> Professional businesses proofread their communications. Poor grammar/spelling suggests: 1) Overseas scam operation (common from Africa, Eastern Europe), 2) Mass-sent automated messages, 3) Unprofessional operation. In Malaysia, even small businesses communicate clearly. Exceptions: Individual seller with language barriers, but verify extra thoroughly. Ask detailed questions to gauge legitimacy.',
        'evasive': '<strong>Evasive = Deceptive:</strong> Legitimate businesses answer questions directly. Evasive tactics: 1) Answering different question than asked, 2) Providing vague non-answers, 3) Deflecting with pressure ("We need to decide now!"), 4) Getting defensive or hostile when questioned. Test: Ask specific questions requiring concrete answers (registration number, physical address, industry certifications). If they dodge, walk away.',
        'pressuring': '<strong>High-Pressure Tactics Exposed:</strong> Psychological manipulation techniques scammers use: 1) Artificial scarcity ("Only 2 left!"), 2) Time pressure ("Offer ends in 1 hour!"), 3) Social pressure ("Everyone\'s buying!"), 4) Threatening losses ("You\'ll miss out!"), 5) Anger/intimidation. Legitimate Malaysian businesses respect your decision-making time. If you feel pressured, it\'s designed to bypass your rational thinking - STOP.',
        'normal': '<strong>Professional Communication Standard:</strong> Good business communication: Clear and timely responses, addresses your concerns directly, maintains professional tone, provides requested information willingly, respects boundaries, gives you space to decide. Even during negotiations, professionalism remains. This should be your baseline expectation.',
        'excellent': '<strong>Transparent Communication:</strong> Best practices: Proactively provides information, anticipates your concerns, offers additional resources, explains processes clearly, maintains consistent messaging, admits limitations honestly, provides multiple contact methods. Transparency indicates confidence and legitimacy - nothing to hide.'
      },
      meeting: {
        'refuses': '<strong>Refusal to Meet = Red Alert:</strong> Why scammers refuse meetings: 1) Not in Malaysia (overseas operation), 2) Hiding identity (wanted by police), 3) Using stolen photos/fake persona, 4) Plan to disappear after scamming. For local transactions, insisting on meeting in-person is your right. For online sellers: video call minimum. Any excuse is suspicious - "too busy", "camera broken", "privacy concerns". Don\'t proceed.',
        'text-only': '<strong>Text-Only Limitation:</strong> Why text-only is risky: 1) Can\'t verify voice/video = can\'t confirm identity, 2) Easy to copy/paste scripted scam responses, 3) Can be multiple people using same account, 4) WhatsApp account hijacking is common in Malaysia. For significant transactions, minimum requirement: Voice call, ideally video. Save all text conversations as evidence.',
        'phone-only': '<strong>Phone-Only Concerns:</strong> Phone calls are better than text but risks remain: 1) Caller ID spoofing (displaying fake numbers), 2) Voice changers can deceive, 3) Can\'t verify visual identity, 4) No paper trail (record calls if legal in your area). In Malaysia, scammers spoof bank/police numbers. Solution: Never call numbers they provide - look up official numbers yourself and call those. Request video call for high-value deals.',
        'video-willing': '<strong>Video Call Verification:</strong> Video call best practices: 1) Request ID verification on camera (MyKad), 2) Ask them to show physical office/location, 3) Record the call (with permission), 4) Ask unexpected questions to verify authenticity, 5) Check if background matches claimed location. Watch for: Pre-recorded video, poor connection excuses to avoid video, generic backgrounds. Video greatly reduces scam risk.',
        'in-person': '<strong>Safe In-Person Meetings:</strong> Meeting safely in Malaysia: âœ“ Public places (mall, bank, coffee shop), âœ“ Daytime meetings, âœ“ Bring someone with you, âœ“ Police station for high-value items, âœ“ Inspect items thoroughly, âœ“ Count cash carefully, âœ“ Get receipts/documentation. âœ— DON\'T: Meet at private homes (theirs or yours), secluded areas, late night, alone for expensive items. Trust your instincts.'
      },
      references: {
        'refuses': '<strong>Reference Refusal Warning:</strong> When someone refuses references or gets defensive, it means: 1) No previous satisfied customers, 2) Hiding poor track record, 3) Likely scam with zero legitimate transactions. In Malaysia, even small businesses have Facebook pages with reviews. Ask yourself: If their service is good, why hide references? This should end the conversation immediately.',
        'fake': '<strong>Spotting Fake References:</strong> Red flags for fake references: 1) All reviews 5-stars with generic praise, 2) Reviews posted on same dates, 3) Reviewer profiles created recently, 4) Similar writing styles, 5) No negative reviews ever, 6) References only reachable through seller. Verify: Google reviewer names, call references yourself (not numbers provided by seller), check multiple review platforms, look for detailed specific feedback.',
        'limited': '<strong>Limited References Verification:</strong> New businesses have few references - verify them thoroughly: 1) Contact each reference personally, 2) Ask specific questions about their experience, 3) Verify references are real people (LinkedIn, Facebook), 4) Ask to see proof of completed projects/sales, 5) Start with smaller transaction to test, 6) Check if owner has history in industry even if company is new.',
        'provides': '<strong>Verify Provided References:</strong> Don\'t just accept references at face value. Verification steps: 1) Contact through independent channels (find their contact info yourself), 2) Ask detailed questions (timeline, problems encountered, resolution), 3) Verify their identity (LinkedIn profiles, company websites), 4) Check recent reviews on Google/Facebook, 5) Look for complaints on Lowyat Forum or Malaysia consumer sites, 6) Ask if they would use the service again.',
        'extensive': '<strong>Extensive Track Record Value:</strong> Long history provides: Better accountability (reputation to protect), Verifiable performance pattern, More data points for assessment, Established processes and professionalism. Still verify: Are reviews recent or all old? Any changes in management? Google company name + "scam" or "complaint". Check SSM for company age. Even established companies can have rogue employees.'
      },
      unusualRequests: {
        'lie-to-others': '<strong>CRITICAL - Lying Request = SCAM:</strong> If they ask you to lie to ANYONE (bank, employer, family, authorities), this is 100% a scam and likely criminal activity. Common scenarios in Malaysia: "Tell your bank this transfer is for business", "Don\'t tell your family about this investment", "Say you\'re paying for services if asked". This is money laundering or fraud. STOP ALL COMMUNICATION. Report to Bank Negara Malaysia and Royal Malaysia Police cyber crime division immediately.',
        'secrecy': '<strong>Secrecy Demands Exposed:</strong> Scammers demand secrecy to: 1) Isolate you from advice, 2) Prevent verification by others, 3) Avoid detection, 4) Control narrative. Common excuses: "Exclusive deal", "Confidentiality agreement", "Don\'t want competition to know". Legitimate business reasons exist (M&A, patents) BUT these involve lawyers and formal NDAs from established firms. For regular transactions, secrecy is red flag. Always discuss major transactions with trusted advisors.',
        'personal-info': '<strong>Excessive Info Requests:</strong> Identity theft is rampant in Malaysia. NEVER share: 1) IC front/back photos, 2) Bank account passwords/PINs, 3) OTP codes, 4) Credit card CVV, 5) Social Security/EPF details, 6) MyKad chip data. Legitimate businesses need: Name, contact info, delivery address, possibly IC number (for contracts). Banks/Government NEVER ask for passwords or OTP. If website requests unusual info, close it immediately.',
        'minor-concerns': '<strong>Trust Your Gut Feeling:</strong> Your subconscious detects red flags before your conscious mind. If something feels "off" but you can\'t pinpoint why, investigate further. Common "minor" concerns that ARE significant: Slightly odd wording, small inconsistencies, mild pressure, unusual payment timing, slightly vague answers. Don\'t dismiss intuition - it\'s your brain protecting you. Ask more questions, verify details, or walk away.',
        'none': '<strong>No Red Flags - Still Be Cautious:</strong> Even when everything seems legitimate: 1) Use secure payment methods (not gift cards/crypto), 2) Keep all documentation, 3) Don\'t share unnecessary info, 4) Verify key facts independently, 5) Get everything in writing, 6) Know your legal rights. Scammers can be sophisticated. The best protection is following standard security practices for ALL transactions, regardless of how legitimate they appear.',
        'not-applicable': '<strong>Too Early to Assess Unusual Requests:</strong> If you haven\'t had enough interaction yet, that\'s understandable. <strong>Key point:</strong> Scammers typically don\'t make unusual requests immediately - they build trust first by being helpful, professional, and reasonable. They wait until you\'re comfortable before making suspicious requests. Just because there are "no unusual requests yet" doesn\'t mean you\'re safe - it may mean you\'re still in the trust-building phase. As the transaction progresses, watch for these red flags appearing: Requests for excessive personal information, demands for secrecy, pressure to act without documentation, requests to lie or mislead others, asking for account access. Any sudden shift from reasonable to unreasonable requests is a warning sign.'
      },
      representative: {
        'direct-owner': '<strong>Dealing with Business Owner:</strong> Best accountability scenario. Verify ownership: 1) Check SSM (Companies Commission of Malaysia) - search company name, confirm director matches, 2) Request business card, 3) Video call to verify face matches IC, 4) Check LinkedIn profile history, 5) Visit physical business location if local. Owner has most to lose from bad reputation, so generally more trustworthy. Still get contracts and documentation.',
        'authorized-rep': '<strong>Verifying Representatives:</strong> Representatives are normal for medium/large companies. Verification: 1) Request authorization letter on company letterhead, 2) Call company directly (look up number yourself) to confirm person works there, 3) Check employee LinkedIn/company website directory, 4) Get direct supervisor contact, 5) Meet at company office, 6) Authorization letter should specify scope of authority. Be wary if they resist verification.',
        'unclear-rep': '<strong>Unclear Representation = STOP:</strong> You MUST know who has authority to transact. Demand clarity: Who do you work for? (Get company details), What\'s your role? (Get title, responsibilities), Who\'s your superior? (Get contact to verify), Show authorization documentation. If they\'re vague or change answers, assume scam. In Malaysia, legitimate businesses clearly identify representatives. Unclear = Hiding something = Don\'t transact.',
        'multiple-people': '<strong>Multiple Contacts Red Flag:</strong> Many people involved without clear roles suggests: 1) Scam network (different people play different roles), 2) Disorganized illegitimate operation, 3) Attempting to confuse you. Legitimate scenario: Sales person, technical specialist, finance department. Ask for: Organization chart, each person\'s role/title, why multiple people needed, supervisor contact. If still unclear or they avoid answering, high scam risk.',
        'keeps-changing': '<strong>Changing Contacts = SCAM INDICATOR:</strong> Constantly changing who you talk to means: 1) No consistent point person = disorganized scam, 2) Previous person disappeared = scam pattern, 3) Avoiding accountability, 4) Confusing you intentionally. Legitimate reasons (employee left) should be: Explained clearly, New contact introduced properly, Continuity maintained, Previous agreements honored. If contacts keep vanishing without explanation, STOP - likely scam network operation.'
      }
    };

    // Load and display statistics
    async function loadStats() {
      try {
        const response = await fetch('/api/scam-stats');
        const data = await response.json();
        
        const totalChecksEl = document.getElementById('totalChecks');
        const todayChecksEl = document.getElementById('todayChecks');
        const topScamTypesEl = document.getElementById('topScamTypes');
        
        if (totalChecksEl && todayChecksEl) {
          // Animate the numbers
          animateCounter(totalChecksEl, data.totalChecks || 0);
          animateCounter(todayChecksEl, data.todayChecks || 0);
        }

        // Display top scam types
        if (topScamTypesEl && data.topScamTypes && data.topScamTypes.length > 0) {
          // Find max count for bar width calculation
          const maxCount = Math.max(...data.topScamTypes.map((item: any) => item.count));
          
          topScamTypesEl.innerHTML = data.topScamTypes.map((item: any, index: number) => {
            const percentage = (item.count / maxCount) * 100;
            const barColor = index === 0 ? 'bg-indigo-500' : index === 1 ? 'bg-indigo-600' : 'bg-indigo-700';
            
            return `
              <div class="space-y-1">
                <div class="flex items-center justify-between text-xs">
                  <span class="text-gray-300 font-medium">${item.label}</span>
                  <span class="text-indigo-400 font-semibold ml-2">${item.count.toLocaleString()}</span>
                </div>
                <div class="w-full bg-gray-800 rounded-full h-2">
                  <div class="${barColor} h-2 rounded-full transition-all duration-500" style="width: ${percentage}%"></div>
                </div>
              </div>
            `;
          }).join('');
        } else if (topScamTypesEl) {
          topScamTypesEl.innerHTML = '<div class="text-gray-500 text-xs">No data yet - be the first to check!</div>';
        }
      } catch (error) {
        console.error('Failed to load stats:', error);
        // Show fallback values
        const totalChecksEl = document.getElementById('totalChecks');
        const todayChecksEl = document.getElementById('todayChecks');
        const topScamTypesEl = document.getElementById('topScamTypes');
        
        if (totalChecksEl) totalChecksEl.textContent = '---';
        if (todayChecksEl) todayChecksEl.textContent = '---';
        if (topScamTypesEl) topScamTypesEl.innerHTML = '<div class="text-gray-500 text-xs">Unable to load</div>';
      }
    }

    function animateCounter(element: HTMLElement, targetValue: number) {
      const duration = 1500; // 1.5 seconds
      const startValue = 0;
      const startTime = performance.now();
      
      element.classList.remove('animate-pulse');
      
      function update(currentTime: number) {
        const elapsed = currentTime - startTime;
        const progress = Math.min(elapsed / duration, 1);
        
        // Ease out animation
        const easeOut = 1 - Math.pow(1 - progress, 3);
        const currentValue = Math.floor(startValue + (targetValue - startValue) * easeOut);
        
        element.textContent = currentValue.toLocaleString();
        
        if (progress < 1) {
          requestAnimationFrame(update);
        }
      }
      
      requestAnimationFrame(update);
    }

    async function incrementStats(formData: Record<string, string>) {
      try {
        await fetch('/api/scam-stats', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            userRole: formData.situation || formData.userRole, // Use situation (new field) or fallback to userRole
            communicationMedium: formData.communicationMedium,
            paymentMethod: formData.paymentMethod,
            socialEngineering: formData.socialEngineering || formData.redFlags // Use socialEngineering or new redFlags
          })
        });
        // Reload stats after incrementing
        setTimeout(loadStats, 500);
      } catch (error) {
        console.error('Failed to increment stats:', error);
        // Don't block the user experience if stats fail
      }
    }

    // Handle button selections
    document.addEventListener('DOMContentLoaded', () => {
    const copyShareLink = document.getElementById('copyShareLink');
    const shareFeedback = document.getElementById('shareFeedback');
    const socialShareLinks = document.querySelectorAll('.astro-social-share a.social-share-btn') as NodeListOf<HTMLAnchorElement>;
      const disclaimerBanner = document.getElementById('disclaimerBanner');
      const dismissDisclaimer = document.getElementById('dismissDisclaimer');
      const DISCLAIMER_STORAGE_KEY = 'scamCheckerDisclaimerDismissed';

      // Load stats on page load
      loadStats();

      // Restart assessment button handler
      document.getElementById('restartBtn')?.addEventListener('click', function() {
        // Reset the form
        const form = document.getElementById('scamCheckerForm') as HTMLFormElement;
        if (form) {
          form.reset();
        }
        
        // Reset all selections
        document.querySelectorAll('.option-btn, .option-btn-full, .option-btn-checkbox').forEach(btn => {
          btn.classList.remove('selected');
        });
        
        // Reset checkboxes
        document.querySelectorAll('.option-btn-checkbox .checkbox-indicator').forEach(indicator => {
          indicator.textContent = 'â˜';
        });
        
        // Reset hidden inputs
        document.querySelectorAll('input[type="hidden"]').forEach(input => {
          (input as HTMLInputElement).value = '';
        });
        
        // Hide all info boxes
        document.querySelectorAll('.info-box').forEach(box => {
          box.classList.add('hidden');
        });
        
        // Reset state
        showingResults = false;
        currentQuestionIndex = 1;
        visibleQuestions = [1, 2, 3, 4, 5, 6, 7, 8]; // Will be recalculated by getVisibleQuestions()
        
        // Hide results
        document.getElementById('results')?.classList.remove('active');
        
        // Show navigation buttons
        document.getElementById('navigationButtons')?.classList.remove('hidden');
        
        // Show first question
        updateQuestionDisplay();
        
        // Scroll to top of form
        document.getElementById('scamCheckerForm')?.scrollIntoView({ behavior: 'smooth', block: 'start' });
      });

      function showShareFeedback(message: string, isError = false) {
        if (!shareFeedback) {
          return;
        }
        shareFeedback.textContent = message;
        shareFeedback.classList.remove('hidden');
        if (isError) {
          shareFeedback.classList.add('text-red-300');
          shareFeedback.classList.remove('text-indigo-300');
        } else {
          shareFeedback.classList.remove('text-red-300');
          shareFeedback.classList.add('text-indigo-300');
        }
      }

      // Disclaimer dismissal handling
      try {
        if (localStorage.getItem(DISCLAIMER_STORAGE_KEY) === 'true') {
          disclaimerBanner?.classList.add('hidden');
        }
      } catch (error) {
        console.warn('Unable to read disclaimer preference', error);
      }

      dismissDisclaimer?.addEventListener('click', () => {
        disclaimerBanner?.classList.add('hidden');
        try {
          localStorage.setItem(DISCLAIMER_STORAGE_KEY, 'true');
        } catch (error) {
          console.warn('Unable to persist disclaimer preference', error);
        }
      });

      copyShareLink?.addEventListener('click', async () => {
        const shareData = getShareData();
        try {
          if ('clipboard' in navigator && navigator.clipboard?.writeText) {
            await navigator.clipboard.writeText(shareData.url);
            showShareFeedback('Link copied! Share it with someone who needs it.');
          } else {
            throw new Error('Clipboard API unavailable');
          }
        } catch (error) {
          showShareFeedback('Copy failed. Use the share icons or copy manually.', true);
          window.prompt('Copy this link to share', shareData.url);
        }
      });

      socialShareLinks.forEach(link => {
        link.addEventListener('click', () => {
          showShareFeedback('Opening your share optionâ€¦');
        });
      });

      // Initialize first question
      updateQuestionDisplay();

      // Navigation button handlers
      document.getElementById('prevBtn')?.addEventListener('click', prevQuestion);
      document.getElementById('nextBtn')?.addEventListener('click', nextQuestion);
      
      // Submit button handler (since it's outside the form now)
      document.getElementById('submitBtn')?.addEventListener('click', function() {
        console.log('Submit button clicked!'); // Debug log
        const form = document.getElementById('scamCheckerForm') as HTMLFormElement;
        if (form) {
          console.log('Form found, dispatching submit event'); // Debug log
          // Trigger form submission
          const submitEvent = new Event('submit', { cancelable: true, bubbles: true });
          form.dispatchEvent(submitEvent);
        } else {
          console.error('Form not found!'); // Debug log
        }
      });

      // Critical red flags that trigger fast exit warning
      const criticalRedFlags: Record<string, string[]> = {
        paymentMethod: ['gift-cards'],
        unusualRequests: ['lie-to-others', 'account-access'],
        communicationMedium: ['whatsapp-group'],
        socialEngineering: ['fear', 'authority'],
        location: ['secluded-area'],
        whoMeeting: ['unclear-evasive', 'sending-someone-else']
      };

      // Check if selection is a critical red flag
      function checkCriticalRedFlag(field: string, value: string) {
        if (criticalRedFlags[field]?.includes(value)) {
          // Show immediate warning modal
          showCriticalWarning(field, value);
          return true;
        }
        return false;
      }

      // Show critical warning modal with option to exit or continue
      function showCriticalWarning(field: string, value: string) {
        const warningMessages: Record<string, Record<string, string>> = {
          paymentMethod: {
            'gift-cards': 'ğŸš¨ <strong>CRITICAL WARNING - STOP!</strong><br><br>Payment via gift cards is the #1 indicator of a scam. <strong>No legitimate business EVER accepts gift cards as payment.</strong><br><br>This is almost certainly a scam. We strongly recommend stopping immediately.'
          },
          unusualRequests: {
            'lie-to-others': 'ğŸš¨ <strong>CRITICAL WARNING - CRIMINAL ACTIVITY!</strong><br><br>Anyone asking you to lie to others is involving you in fraud or money laundering. <strong>This is illegal and you could face criminal charges.</strong><br><br>STOP ALL COMMUNICATION IMMEDIATELY and report to authorities.',
            'account-access': 'ğŸš¨ <strong>CRITICAL WARNING - FRAUD ALERT!</strong><br><br>Asking for your account access, passwords, or OTP codes is a MAJOR red flag. <strong>No bank or legitimate business will EVER ask for this.</strong><br><br>This is identity theft or fraud in progress. STOP IMMEDIATELY.'
          },
          communicationMedium: {
            'whatsapp-group': 'ğŸš¨ <strong>CRITICAL WARNING - INVESTMENT SCAM!</strong><br><br>WhatsApp group investment schemes are the #1 scam in Malaysia right now. <strong>ALL the "members" are fake accounts controlled by scammers.</strong><br><br>The "profits" shown are fake. The initial small payment is BAIT. This is 100% a scam.'
          },
          socialEngineering: {
            'fear': 'ğŸš¨ <strong>CRITICAL WARNING - MACAU SCAM!</strong><br><br>Using fear and threats is a classic Macau Scam tactic. <strong>Real authorities NEVER threaten arrest over phone/messages.</strong><br><br>Hang up immediately and call the real organization using publicly listed numbers.',
            'authority': 'ğŸš¨ <strong>CRITICAL WARNING - IMPERSONATION!</strong><br><br>Impersonating police, banks, or government officials is illegal. <strong>Real authorities follow proper procedures and send official letters.</strong><br><br>This is likely a Macau Scam. Report to CCID at 997.'
          },
          location: {
            'secluded-area': 'ğŸš¨ <strong>CRITICAL DANGER - PERSONAL SAFETY RISK!</strong><br><br>Meeting in secluded areas is EXTREMELY DANGEROUS. <strong>This could be a robbery, assault, or worse.</strong><br><br>Legitimate businesses NEVER meet in secluded locations. DO NOT GO! Report to police if threatened.'
          },
          whoMeeting: {
            'unclear-evasive': 'ğŸš¨ <strong>CRITICAL WARNING!</strong><br><br>Refusing to clearly state who will meet you indicates they are hiding their identity. <strong>This is a major scam indicator.</strong><br><br>Scammers avoid face-to-face meetings because they don\'t want to be identified. Do not proceed.',
            'sending-someone-else': 'ğŸš¨ <strong>MAJOR WARNING - IDENTITY HIDING!</strong><br><br>Sending a "friend" or "family member" instead of meeting personally is a classic scam tactic in Malaysia. <strong>They are avoiding identity verification.</strong><br><br>This is often a robbery setup or scam handoff. INSIST they meet personally or walk away.',
            'person-approached-me': 'âš ï¸ <strong>IN-PERSON APPROACH WARNING</strong><br><br>When someone approaches you in public with a business offer, this requires extra caution. <strong>Common street scams in Malaysia:</strong> fake charity collections, pyramid schemes, "help transfer money" (money mule), gold/jewelry scams.<br><br>VERIFY: Request business card and company registration, meet at their registered office, bring someone with you.'
          },
          relationshipBuilding: {
            'unsolicited-contact': 'ğŸš¨ <strong>UNSOLICITED CONTACT - HIGH RISK!</strong><br><br>When THEY contact YOU first, this is how most scams begin. Common in Malaysia: job scams, investment offers, business proposals, romance scams.<br><br><strong>Take extreme caution:</strong> Verify independently, never share sensitive info, research thoroughly before engaging.',
            'added-to-group': 'ğŸš¨ <strong>CRITICAL - WHATSAPP GROUP SCAM EPIDEMIC!</strong><br><br>Being added to investment groups is THE most common scam in Malaysia 2024-2025! <strong>ALL group members are fake accounts controlled by scammers.</strong><br><br>They show fake profits, send small amount first as bait, then disappear with your money. LEAVE GROUP immediately!',
            'quick-intimacy': 'ğŸš¨ <strong>LOVE SCAM TACTIC DETECTED!</strong><br><br>Rushing to personal/romantic topics is a manipulation strategy. <strong>They create emotional connection to cloud your judgment.</strong><br><br>Real relationships develop naturally over time. If they\'re pushing emotional intimacy quickly while also involving money or business, it\'s a romance scam.'
          }
        };

        const message = warningMessages[field]?.[value] || 'This is a critical red flag indicating high scam risk.';
        
        // Create modal overlay
        const modalHTML = `
          <div id="criticalWarningModal" class="fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50 p-4" style="animation: fadeIn 0.3s;">
            <div class="bg-gradient-to-br from-red-900/90 to-gray-900/90 border-2 border-red-500 rounded-2xl p-6 max-w-lg w-full shadow-2xl" style="animation: slideUp 0.3s;">
              <div class="flex items-start mb-4">
                <svg class="w-12 h-12 text-red-400 mr-4 flex-shrink-0 animate-pulse" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/>
                </svg>
                <div class="flex-1">
                  <h3 class="text-2xl font-bold text-white mb-3">STOP AND READ THIS</h3>
                  <div class="text-gray-200 text-sm leading-relaxed mb-6">
                    ${message}
                  </div>
                  <div class="space-y-3">
                    <button 
                      id="exitToResults" 
                      class="w-full bg-red-600 hover:bg-red-500 text-white font-semibold py-3 px-6 rounded-lg transition-all shadow-lg"
                    >
                      âš ï¸ Show Me the Risk Assessment Now
                    </button>
                    <button 
                      id="continueAnyway" 
                      class="w-full bg-gray-700 hover:bg-gray-600 text-gray-300 font-medium py-2 px-6 rounded-lg transition-all text-sm"
                    >
                      I understand the risk, let me continue
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <style>
            @keyframes fadeIn {
              from { opacity: 0; }
              to { opacity: 1; }
            }
            @keyframes slideUp {
              from { transform: translateY(20px); opacity: 0; }
              to { transform: translateY(0); opacity: 1; }
            }
          </style>
        `;
        
        // Remove existing modal if any
        document.getElementById('criticalWarningModal')?.remove();
        
        // Add modal to page
        document.body.insertAdjacentHTML('beforeend', modalHTML);
        
        // Handle exit to results
        document.getElementById('exitToResults')?.addEventListener('click', () => {
          document.getElementById('criticalWarningModal')?.remove();
          // Gather current form data and submit
          const form = document.getElementById('scamCheckerForm') as HTMLFormElement;
          if (form) {
            const submitEvent = new Event('submit', { cancelable: true, bubbles: true });
            form.dispatchEvent(submitEvent);
          }
        });
        
        // Handle continue anyway
        document.getElementById('continueAnyway')?.addEventListener('click', () => {
          document.getElementById('criticalWarningModal')?.remove();
        });
      }

      const allOptionButtons = document.querySelectorAll('.option-btn, .option-btn-full');
      const checkboxButtons = document.querySelectorAll('.option-btn-checkbox');
      
      // Handle single-select buttons
      allOptionButtons.forEach(button => {
        button.addEventListener('click', function(e) {
          e.preventDefault();
          const field = this.getAttribute('data-field');
          const value = this.getAttribute('data-value');
          
          // Remove selected class from all buttons in this field
          document.querySelectorAll(`[data-field="${field}"]`).forEach(btn => {
            btn.classList.remove('selected');
          });
          
          // Add selected class to clicked button
          this.classList.add('selected');
          
          // Update hidden input value
          const hiddenInput = document.querySelector(`input[name="${field}"]`);
          if (hiddenInput) {
            hiddenInput.value = value;
          }

          // Show educational info box if content exists
          if (educationalContent[field] && educationalContent[field][value]) {
            const infoBox = document.getElementById(`info-${field}`);
            const infoContent = document.getElementById(`info-content-${field}`);
            
            if (infoBox && infoContent) {
              infoContent.innerHTML = educationalContent[field][value];
              infoBox.classList.remove('hidden');
              
              // Smooth scroll to show the info box
              setTimeout(() => {
                infoBox.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
              }, 100);
            }
          }

          // Check for critical red flag and show warning if needed
          checkCriticalRedFlag(field, value);

          // Update button states after selection
          updateQuestionDisplay();
        });
      });

      // Handle multi-select checkbox buttons (for partyInfo)
      checkboxButtons.forEach(button => {
        button.addEventListener('click', function(e) {
          e.preventDefault();
          const field = this.getAttribute('data-field');
          const value = this.getAttribute('data-value');
          
          // Toggle selected class
          this.classList.toggle('selected');
          
          // Update checkbox indicator
          const indicator = this.querySelector('.checkbox-indicator');
          if (indicator) {
            indicator.textContent = this.classList.contains('selected') ? 'â˜‘' : 'â˜';
          }
          
          // Collect all selected values
          const selectedButtons = document.querySelectorAll(`[data-field="${field}"].selected`);
          const selectedValues = Array.from(selectedButtons).map(btn => btn.getAttribute('data-value'));
          
          // Update hidden input with comma-separated values
          const hiddenInput = document.querySelector(`input[name="${field}"]`);
          if (hiddenInput) {
            hiddenInput.value = selectedValues.join(',');
          }

          // Show info box for partyInfo
          const infoBox = document.getElementById(`info-${field}`);
          if (infoBox && selectedValues.length > 0) {
            infoBox.classList.remove('hidden');
          } else if (infoBox && selectedValues.length === 0) {
            infoBox.classList.add('hidden');
          }

          // Update button states after selection
          updateQuestionDisplay();
        });
      });
    });

    // Risk scoring system
    const riskScores = {
      situation: {
        'buying': 0,
        'selling': 0,
        'contacted': 20, // Unsolicited contact is high risk
        'approached': 25, // In-person approaches are suspicious
        'group-added': 35, // Group scams are epidemic
        'partnership': 5,
        'checking': 0
      },
      // Red flags scoring - each flag adds to risk
      redFlags: {
        // Critical red flags
        'lie-to-others': 35,
        'secrecy': 25,
        'account-access': 30,
        'secluded-location': 30,
        'whatsapp-group': 35,
        'sending-someone-else': 28,
        'evasive-identity': 30,
        // Warning signs
        'extreme-urgency': 20,
        'too-good': 30,
        'fear-tactics': 25,
        'location-changing': 25,
        'refuses-documentation': 25,
        'excessive-info': 20,
        'fake-social-proof': 20,
        'small-payment-first': 15,
        'unclear-representation': 15,
        // Status
        'none': 0,
        'too-early': 0
      },
      location: {
        'online-only': 3,
        'public-place': 0,
        'street-public': 5,
        'office-business': 0,
        'private-residence': 8,
        'secluded-area': 30,
        'keeps-changing': 25,
        'refuses-specify': 15,
        'not-applicable': 0
      },
      whoMeeting: {
        'person-directly': 0,
        'person-approached-me': 8,
        'authorized-representative': 2,
        'sending-someone-else': 28,
        'courier-delivery': 5,
        'unclear-evasive': 30,
        'online-no-meeting': 3,
        'not-applicable': 0
      },
      communicationMedium: {
        'email': 2,
        'sms': 15,
        'whatsapp': 5,
        'whatsapp-group': 35,
        'telegram': 8,
        'social-media': 10,
        'phone-call': 3,
        'video-call': 0,
        'business-platform': 2,
        'marketplace': 0,
        'in-person-only': 5,
        'not-started': 0
      },
      relationshipBuilding: {
        'gradual-trust': 0,
        'unsolicited-contact': 22,
        'added-to-group': 35,
        'quick-intimacy': 30,
        'professional-approach': 0,
        'mutual-connection': -5,
        'responded-to-ad': 0,
        'not-sure': 5
      },
      paymentMethod: {
        'gift-cards': 30,
        'cryptocurrency': 25,
        'wire-transfer': 18,
        'money-order': 18,
        'bank-transfer': 8,
        'check': 5,
        'cod': 3,
        'escrow': 0,
        'credit-card': 0,
        'not-discussed': 5
      },
      // PartyInfo uses array scoring - calculated differently
      partyInfo: {
        'phone-number': -2,
        'identification': -5,
        'email': -2,
        'profile-picture': -1,
        'references': -5,
        'age': -1,
        'location': -3,
        'business-registration': -8,
        'social-media': -3,
        'website': -4,
        'reviews': -4,
        'bank-account': -2,
        'minimal-info': 30, // If this is selected, it's a major red flag
        'not-started': 0 // Haven't collected info yet
      }
    };

    document.getElementById('scamCheckerForm')?.addEventListener('submit', function(e) {
      e.preventDefault();
      
      console.log('Form submitted!'); // Debug log
      
      const formData = new FormData(e.target as HTMLFormElement);
      let totalScore = 0;
      const redFlagsList: string[] = [];
      const formAnswers: Record<string, string> = {};
      
      // Store all form answers
      for (const [key, value] of formData.entries()) {
        formAnswers[key] = value as string;
      }
      
      console.log('Form answers:', formAnswers); // Debug log
      
      // Increment stats counter with form data
      incrementStats(formAnswers);
      
      // Calculate total risk score
      for (const [category, value] of formData.entries()) {
        // Handle redFlags multi-select
        if (category === 'redFlags') {
          const selectedFlags = (value as string).split(',').filter(v => v);
          
          // If "none" or "too-early" selected, skip scoring red flags
          if (selectedFlags.includes('none') || selectedFlags.includes('too-early')) {
            totalScore += 0;
          } else {
            // Add score for each selected red flag
            selectedFlags.forEach(flag => {
              const flagScore = riskScores.redFlags[flag as keyof typeof riskScores.redFlags] || 0;
              totalScore += flagScore;
              
              // Add to red flags list if score >= 15
              if (flagScore >= 15) {
                redFlagsList.push(getRedFlagMessage('redFlags', flag));
              }
            });
          }
        }
        // Handle partyInfo separately (multi-select)
        else if (category === 'partyInfo') {
          const selectedItems = (value as string).split(',').filter(v => v);
          
          // If not-started is selected, treat as neutral (early stage)
          if (selectedItems.includes('not-started')) {
            // No score penalty for being in early stages
            totalScore += 0;
          } else if (selectedItems.includes('minimal-info')) {
            // If minimal-info is selected, it's a critical red flag
            totalScore += riskScores.partyInfo['minimal-info'];
            redFlagsList.push('Very little or no information about the other party - extreme risk!');
          } else {
            // Calculate score based on selected items (negative scores = good)
            selectedItems.forEach(item => {
              const itemScore = riskScores.partyInfo[item as keyof typeof riskScores.partyInfo] || 0;
              totalScore += itemScore;
            });
            
            // Base risk if very few items selected (less than 3 = concerning)
            if (selectedItems.length < 3 && selectedItems.length > 0) {
              totalScore += 15;
              redFlagsList.push('Limited verifiable information about the other party');
            }
          }
        } else {
          const score = riskScores[category as keyof typeof riskScores]?.[value as string] || 0;
          totalScore += score;
          
          // Track red flags (items with score >= 15)
          if (score >= 15) {
            redFlagsList.push(getRedFlagMessage(category, value as string));
          }
        }
      }
      
      // Show results
      displayResults(totalScore, redFlagsList, formAnswers);
      
      // Scroll to results
      document.getElementById('results')?.scrollIntoView({ behavior: 'smooth' });
    });

    function getRedFlagMessage(category: string, value: string): string {
      const messages: Record<string, Record<string, string>> = {
        situation: {
          'contacted': 'Unsolicited contact with offers is a high-risk scenario - verify thoroughly',
          'approached': 'ğŸš¨ In-person approaches with business offers are highly suspicious in Malaysia',
          'group-added': 'ğŸš¨ CRITICAL: Investment group scams are the #1 scam type - this is nearly always fraudulent',
          'partnership': 'Partnership opportunities require extensive verification and legal documentation'
        },
        redFlags: {
          'lie-to-others': 'ğŸš¨ CRITICAL: Asking you to lie is fraud/money laundering - stop immediately',
          'secrecy': 'ğŸš¨ Demanding secrecy is an isolation tactic used by scammers',
          'account-access': 'ğŸš¨ CRITICAL: Requesting passwords/OTP/account access is identity theft',
          'secluded-location': 'ğŸš¨ EXTREME DANGER: Meeting in secluded areas poses serious personal safety risks',
          'whatsapp-group': 'ğŸš¨ CRITICAL: WhatsApp group profit schemes are epidemic scams in Malaysia',
          'sending-someone-else': 'ğŸš¨ CRITICAL: Avoiding personal meeting indicates identity hiding',
          'evasive-identity': 'ğŸš¨ Being evasive about identity is a major warning sign',
          'extreme-urgency': 'Extreme urgency pressure is designed to bypass rational thinking',
          'too-good': 'Too-good-to-be-true offers are the #1 psychological hook scammers use',
          'fear-tactics': 'ğŸš¨ Fear and intimidation indicate potential Macau Scam',
          'location-changing': 'Constantly changing locations is highly suspicious behavior',
          'refuses-documentation': 'Refusing documentation means no legal recourse if scammed',
          'excessive-info': 'Excessive personal info requests may indicate identity theft',
          'fake-social-proof': 'Fake testimonials and profit screenshots are easily fabricated',
          'small-payment-first': 'Small initial payments are bait for larger scam investments',
          'unclear-representation': 'Unclear representation indicates lack of legitimate authority'
        },
        userRole: {
          'investor': 'Investment/money-making opportunities have very high scam rates - extreme caution required',
          'partimer': 'Part-time job offers require careful verification - many fake job scams exist',
          'worker': 'Employment offers should be verified - job offer scams are common'
        },
        location: {
          'secluded-area': 'ğŸš¨ CRITICAL: Meeting in secluded areas is extremely dangerous - potential robbery/safety threat',
          'keeps-changing': 'Constantly changing meeting locations is highly suspicious behavior',
          'refuses-specify': 'Refusal to specify location is a concerning red flag',
          'private-residence': 'Meeting at private residences carries personal safety risks'
        },
        whoMeeting: {
          'sending-someone-else': 'ğŸš¨ CRITICAL: Sending someone else instead of coming personally is a major scam indicator - they are likely hiding their identity',
          'unclear-evasive': 'ğŸš¨ EXTREME WARNING: Being evasive about who will meet indicates fraud or malicious intent',
          'courier-delivery': 'Courier delivery requires extra caution - inspect items carefully before payment'
        },
        communicationMedium: {
          'sms': 'SMS-based business communication is highly unusual and suspicious',
          'whatsapp-group': 'ğŸš¨ CRITICAL: WhatsApp group money schemes are nearly ALWAYS scams - the initial payment is bait',
          'social-media': 'Social media-only communication requires extra verification',
          'telegram': 'Telegram communication should be verified carefully due to anonymity'
        },
        socialEngineering: {
          'urgency': 'Extreme urgency pressure is a classic scam tactic to prevent due diligence',
          'fear': 'ğŸš¨ Fear and intimidation tactics indicate potential Macau Scam or authority impersonation',
          'authority': 'ğŸš¨ Authority impersonation is a major scam indicator - verify independently',
          'too-good': 'If a deal seems too good to be true, it almost certainly is',
          'social-proof': 'Fake social proof in controlled environments is a common scam technique',
          'scarcity': 'Artificial scarcity is used to rush your decision-making',
          'reciprocity': 'Small initial payments are often bait for larger scam investments',
          'sympathy': 'Emotional manipulation in business contexts is a warning sign'
        },
        paymentMethod: {
          'gift-cards': 'Payment via gift cards is a major scam indicator - nearly always fraudulent',
          'cryptocurrency': 'Cryptocurrency payments are often used in scams due to irreversibility',
          'wire-transfer': 'Wire transfers are risky as they are difficult to reverse',
          'money-order': 'Money orders can be fraudulent and hard to trace'
        },
        unusualRequests: {
          'lie-to-others': 'ğŸš¨ CRITICAL: Asking you to lie is a major scam indicator - this is fraud',
          'secrecy': 'Demanding unusual secrecy about business dealings is a serious red flag',
          'personal-info': 'Excessive personal information requests may indicate identity theft attempt',
          'account-access': 'ğŸš¨ CRITICAL: Never share account access - this is fraud or money laundering',
          'refuses-documentation': 'Refusal to provide documentation is a critical warning sign',
          'payment-before-meeting': 'Payment before meeting/delivery carries significant risk'
        }
      };
      
      return messages[category]?.[value] || 'This factor raises concerns about legitimacy';
    }

    function displayResults(score: number, redFlags: string[], formAnswers: Record<string, string>) {
      const resultsDiv = document.getElementById('results');
      const resultCard = document.getElementById('resultCard');
      const riskBadge = document.getElementById('riskBadge');
      const riskScore = document.getElementById('riskScore');
      const summaryText = document.getElementById('summaryText');
      const redFlagsList = document.getElementById('redFlagsList');
      const recommendationsList = document.getElementById('recommendationsList');
      const navigationButtons = document.getElementById('navigationButtons');
      const progressBar = document.getElementById('progressBar');
      const currentQuestionSpan = document.getElementById('currentQuestion');
      const totalQuestionsSpan = document.getElementById('totalQuestions');
      const progressPercent = document.getElementById('progressPercent');
      
      if (!resultsDiv || !resultCard || !riskBadge || !riskScore || !summaryText || !redFlagsList || !recommendationsList) return;
      
      // Set showing results flag
      showingResults = true;
      
      // Add analyzing animation
      const analyzingDiv = document.createElement('div');
      analyzingDiv.innerHTML = `
        <div class="fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50" style="animation: fadeIn 0.3s;">
          <div class="bg-gradient-to-br from-gray-900 to-gray-800 border border-indigo-500 rounded-2xl p-8 max-w-md text-center shadow-2xl" style="animation: scaleIn 0.5s;">
            <div class="animate-spin w-16 h-16 border-4 border-indigo-500 border-t-transparent rounded-full mx-auto mb-4"></div>
            <h3 class="text-2xl font-bold text-white mb-2">Analyzing Your Answers...</h3>
            <p class="text-gray-400">Calculating risk score and checking red flags</p>
          </div>
        </div>
        <style>
          @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
          }
          @keyframes scaleIn {
            from { transform: scale(0.9); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
          }
        </style>
      `;
      document.body.appendChild(analyzingDiv);
      
      // Delay to show analyzing animation
      setTimeout(() => {
        console.log('setTimeout started - removing analyzing overlay'); // Debug
        // Remove analyzing overlay
        analyzingDiv.remove();
        
        console.log('Hiding all question cards'); // Debug
        // Hide all question cards
        document.querySelectorAll('.question-card').forEach(card => {
          card.classList.remove('active');
        });
        
        console.log('Showing results div'); // Debug
        // Show results as a flashcard
        resultsDiv.classList.add('active');
        
        // Update progress to show completion
        if (progressBar) progressBar.style.width = '100%';
        if (currentQuestionSpan) currentQuestionSpan.textContent = 'Results';
        if (totalQuestionsSpan) totalQuestionsSpan.textContent = '8';
        if (progressPercent) progressPercent.textContent = '100';
        
        // Hide navigation buttons
        if (navigationButtons) navigationButtons.classList.add('hidden');
        
        // Scroll to top of results smoothly
        setTimeout(() => {
          resultsDiv.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }, 100);
        
        // Now calculate and display the actual results
        let riskLevel: string;
        let riskColor: string;
        let borderColor: string;
        let summary: string;
        let recommendations: string[];
        
        // Payment method warnings
        const paymentMethodWarnings: Record<string, string> = {
        'gift-cards': 'ğŸš¨ <strong>CRITICAL WARNING - Gift Cards:</strong> Payment via gift cards is nearly ALWAYS a scam! No legitimate business accepts gift cards as payment. This is the #1 payment method used by scammers because it\'s untraceable and irreversible.',
        'cryptocurrency': 'âš ï¸ <strong>High Risk - Cryptocurrency:</strong> Crypto payments are irreversible and mostly untraceable. Scammers love crypto because victims cannot get refunds. Only use with parties you completely trust and verify.',
        'wire-transfer': 'âš ï¸ <strong>Risky - Wire Transfer:</strong> Wire transfers are nearly impossible to reverse. Always verify recipient details through a separate channel before sending money.',
        'money-order': 'âš ï¸ <strong>Risky - Money Order:</strong> Money orders can be counterfeited. Takes days to verify authenticity. Banks may initially accept them, then reverse payment when fraud is discovered.',
        'check': 'âš ï¸ <strong>Caution - Check Payment:</strong> In Malaysia, checks take 2-3 days to clear. Even if money appears in your account initially, the bank can reverse it days later if the check bounces.',
        'bank-transfer': 'â„¹ï¸ <strong>Bank Transfer:</strong> Local bank transfers offer some protection in Malaysia. Verify the account holder name matches the business. Be wary of personal accounts for business transactions.',
        'cod': 'âœ… <strong>Safe Choice - Cash on Delivery:</strong> COD is one of the safest payment methods for in-person transactions. Always meet in public places and inspect items thoroughly before paying.',
        'credit-card': 'âœ… <strong>Safest Option - Credit Card:</strong> Credit cards offer the best buyer protection. You can dispute charges (chargeback) if goods aren\'t delivered or are fraudulent.',
        'escrow': 'âœ… <strong>Very Safe - Escrow:</strong> Escrow holds funds until both parties fulfill their obligations. Ideal for large transactions. Verify the escrow service is legitimate and licensed.'
      };
      
      if (score >= 80) {
        riskLevel = 'ğŸš¨ CRITICAL RISK';
        riskColor = 'bg-red-600 text-white';
        borderColor = 'border-red-500';
        summary = 'This transaction shows MULTIPLE SEVERE red flags indicating a highly likely scam. We strongly recommend NOT proceeding with this transaction.';
        recommendations = [
          'DO NOT proceed with this transaction',
          'Report this to relevant authorities (CCID: 997 or MCMC)',
          'Block all communication with this party',
          'If you\'ve already paid, contact your bank/payment provider immediately',
          'Document all communications for potential legal action',
          'Report to Bank Negara Malaysia if financial fraud suspected'
        ];
      } else if (score >= 50) {
        riskLevel = 'âš ï¸ HIGH RISK';
        riskColor = 'bg-orange-600 text-white';
        borderColor = 'border-orange-500';
        summary = 'This transaction has significant red flags that suggest it may be a scam. Exercise extreme caution and conduct thorough verification before proceeding.';
        recommendations = [
          'Conduct extensive background checks on the party',
          'Verify business registration with SSM (ssm.com.my)',
          'Check with CCID scam hotline: 997',
          'Request formal contracts reviewed by a lawyer',
          'Use secure payment methods with buyer protection',
          'Consider walking away if any concerns remain',
          'Consult with a professional before proceeding'
        ];
      } else if (score >= 20) {
        riskLevel = 'âš¡ MODERATE RISK';
        riskColor = 'bg-yellow-600 text-white';
        borderColor = 'border-yellow-500';
        summary = 'This transaction shows some concerning indicators. While it may be legitimate, additional verification is recommended before proceeding.';
        recommendations = [
          'Verify the business through SSM official registry',
          'Request and review formal documentation',
          'Check for online reviews and reputation',
          'Use secure payment methods with recourse options',
          'Meet in person or via video call before committing',
          'Trust your instincts - if something feels off, investigate further',
          'Start with smaller transaction to test reliability'
        ];
      } else if (score >= 0) {
        riskLevel = 'âœ… LOW RISK';
        riskColor = 'bg-green-600 text-white';
        borderColor = 'border-green-500';
        summary = 'This transaction appears to have few red flags, suggesting it may be legitimate. However, always maintain standard business caution and due diligence.';
        recommendations = [
          'Continue with normal business due diligence',
          'Keep documentation of all communications',
          'Use standard contracts and agreements',
          'Maintain professional payment methods',
          'Stay alert for any changes in behavior or requests',
          'When in doubt, seek professional advice'
        ];
      } else {
        riskLevel = 'ğŸŒŸ VERY LOW RISK';
        riskColor = 'bg-blue-600 text-white';
        borderColor = 'border-blue-500';
        summary = 'This transaction shows positive indicators and appears trustworthy. The other party demonstrates professional behavior and transparency. Still, maintain standard business practices.';
        recommendations = [
          'Proceed with confidence but maintain professionalism',
          'Keep standard documentation and records',
          'Use agreed-upon payment methods and timelines',
          'Maintain clear communication throughout the process',
          'Honor all contractual obligations',
          'Build a positive business relationship'
        ];
      }
      
      console.log('Risk level calculated:', riskLevel, 'Score:', score); // Debug
      riskBadge.textContent = riskLevel;
      riskBadge.className = `inline-block px-6 py-3 rounded-full text-2xl font-bold mb-4 ${riskColor}`;
      resultCard.className = `border rounded-xl p-8 ${borderColor}`;
      riskScore.textContent = `Risk Score: ${score} out of 200 (approximate)`;
      summaryText.textContent = summary;
      console.log('Results displayed successfully'); // Debug
      
      // Clear any previously appended warning divs
      const existingWarnings = summaryText.parentElement?.querySelectorAll('.payment-method-warning, .courier-warning');
      existingWarnings?.forEach(warning => warning.remove());
      
      // Add payment method warning to summary if applicable
      const paymentMethod = formAnswers['paymentMethod'];
      if (paymentMethod && paymentMethodWarnings[paymentMethod]) {
        const warningDiv = document.createElement('div');
        warningDiv.className = 'payment-method-warning mt-4 p-4 bg-gray-800 border-l-4 border-yellow-500 rounded-r-lg';
        warningDiv.innerHTML = `
          <div class="flex items-start">
            <svg class="w-6 h-6 text-yellow-400 mr-3 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/>
            </svg>
            <div class="flex-1 text-gray-300 text-sm leading-relaxed">
              ${paymentMethodWarnings[paymentMethod]}
            </div>
          </div>
        `;
        summaryText.parentElement?.appendChild(warningDiv);
      }
      
      // Add courier/delivery tracking reminder if applicable
      const whoMeeting = formAnswers['whoMeeting'];
      if (whoMeeting === 'courier-delivery') {
        const courierWarningDiv = document.createElement('div');
        courierWarningDiv.className = 'courier-warning mt-4 p-4 bg-blue-900/20 border-l-4 border-blue-500 rounded-r-lg';
        courierWarningDiv.innerHTML = `
          <div class="flex items-start">
            <svg class="w-6 h-6 text-blue-400 mr-3 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
            </svg>
            <div class="flex-1 text-gray-300 text-sm leading-relaxed">
              <strong>ğŸ“¦ Courier/Delivery Service Reminder:</strong> Since the item will be delivered via courier, <strong>ALWAYS request and verify the tracking number</strong> before making any payment. Legitimate sellers will readily provide:
              <ul class="mt-2 space-y-1 list-disc list-inside ml-4">
                <li><strong>Valid tracking number</strong> that you can verify on the courier's official website/app</li>
                <li><strong>Courier company name</strong> (J&T, Poslaju, DHL, Ninja Van, etc.)</li>
                <li><strong>Expected delivery date</strong> and real-time tracking updates</li>
                <li><strong>Proof of shipment</strong> (receipt or screenshot from courier)</li>
              </ul>
              <p class="mt-2"><strong>âš ï¸ Red Flags:</strong> Refuses to share tracking number, claims "courier doesn't provide tracking", tracking number is fake or doesn't work, asks for payment before shipping, uses unknown/unverifiable courier service.</p>
              <p class="mt-2"><strong>âœ“ Best Practice:</strong> Only pay <strong>after</strong> you receive the tracking number and verify it's active on the courier's official platform. For COD, inspect items thoroughly before paying the delivery person.</p>
            </div>
          </div>
        `;
        summaryText.parentElement?.appendChild(courierWarningDiv);
      }
      
      // Display red flags
      if (redFlags.length > 0) {
        redFlagsList.innerHTML = redFlags.map(flag => 
          `<li class="flex items-start text-gray-300 text-sm">
            <svg class="w-4 h-4 text-red-400 mr-2 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
            </svg>
            ${flag}
          </li>`
        ).join('');
      } else {
        document.getElementById('redFlags')!.innerHTML = 
          `<h3 class="text-base sm:text-lg font-semibold text-white mb-2 flex items-center">
            <svg class="w-5 h-5 text-green-400 mr-2 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
            </svg>
            No Major Red Flags
          </h3>
          <p class="text-gray-300 text-sm">No critical warning signs detected, but always maintain due diligence.</p>`;
      }
      
      // Display recommendations
      recommendationsList.innerHTML = recommendations.map(rec => 
        `<li class="flex items-start text-gray-300 text-sm">
          <svg class="w-4 h-4 text-indigo-400 mr-2 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
          </svg>
          ${rec}
        </li>`
      ).join('');
      
      }, 1500); // End of setTimeout for displaying results
    }
  </script>
</MainLayout>
